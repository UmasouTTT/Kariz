Clear buffer cache on HDFS cluster
Running Pig Query Q1
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q1.pig

60   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
61   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
946  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1060 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1568 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q1.pig-db7cf66b-bdad-4c51-8d90-f764300e0279
1570 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2414 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_CHARARRAY 1 time(s).
2414 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 3 time(s).
2449 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: GROUP_BY,ORDER_BY,FILTER
2487 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2522 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2564 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2684 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for LineItems: $0, $1, $2, $3, $11, $12, $13, $14, $15
2818 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-991880773 and resources directory is /tmp/temp-991880773
2851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2905 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2936 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-107 and vertex - scope-117
3034 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3080 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3095 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3564 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3565 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3565 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3565 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3839 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-106: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3839 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: LineItems,PriceSummary,StatusGroup,SubLine,SubLineItems
3839 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: LineItems[3,12],SubLineItems[4,15],LineItems[-1,-1],SubLine[6,10],PriceSummary[9,15],StatusGroup[8,14]
3839 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3908 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-107: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3909 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: PriceSummary,SortedSummary
3909 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: PriceSummary[9,15],SortedSummary[10,16]
3909 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
3980 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-117: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3980 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
3980 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
3980 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4007 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-128: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4007 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: SortedSummary
4007 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: SortedSummary[10,16]
4008 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4041 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-130: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4041 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4041 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4041 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4081 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 8
4122 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8813 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q1.pig-0_scope-0
9308 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q1.pig-0_scope-0. Application id: application_1564404443351_0025
10115 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0025
10310 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 8 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30310 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 8 Succeeded: 2 Running: 2 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
41479 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 8 Succeeded: 8 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=Counters: 85
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=1
		NUM_SUCCEEDED_TASKS=8
		TOTAL_LAUNCHED_TASKS=8
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=4
		AM_CPU_MILLISECONDS=3510
		AM_GC_TIME_MILLIS=96
	File System Counters
		FILE_BYTES_READ=3072
		FILE_BYTES_WRITTEN=3596
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=376276078
		HDFS_BYTES_WRITTEN=571
		HDFS_READ_OPS=7
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=1
		REDUCE_INPUT_GROUPS=12
		REDUCE_INPUT_RECORDS=24
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=48
		NUM_SHUFFLED_INPUTS=8
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=6
		GC_TIME_MILLIS=4147
		CPU_MILLISECONDS=95320
		PHYSICAL_MEMORY_BYTES=9149874176
		VIRTUAL_MEMORY_BYTES=54282452992
		COMMITTED_HEAP_BYTES=9149874176
		INPUT_RECORDS_PROCESSED=2999676
		INPUT_SPLIT_LENGTH_BYTES=376276078
		OUTPUT_RECORDS=2957144
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=257270833
		OUTPUT_BYTES_WITH_OVERHEAD=2506
		OUTPUT_BYTES_PHYSICAL=2586
		ADDITIONAL_SPILLS_BYTES_WRITTEN=802
		ADDITIONAL_SPILLS_BYTES_READ=2097
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=6
		SHUFFLE_BYTES=2538
		SHUFFLE_BYTES_DECOMPRESSED=2506
		SHUFFLE_BYTES_TO_MEM=844
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=1694
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=8286
		MERGE_PHASE_TIME=8253
		FIRST_EVENT_RECEIVED=104
		LAST_EVENT_RECEIVED=8239
	MultiStoreCounters
		Output records in _0_Q1out=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=2957123
		COMBINE_OUTPUT_RECORDS=16
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('true','true')
		approx_invocations=100
		approx_microsecs=160200
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=11829600
		approx_microsecs=2427400
	org.apache.pig.builtin.COUNT$Final
		approx_invocations=100
		approx_microsecs=63200
	org.apache.pig.builtin.COUNT$Initial
		approx_invocations=2957400
		approx_microsecs=447000
	org.apache.pig.builtin.COUNT$Intermediate
		approx_invocations=400
		approx_microsecs=9822300
	org.apache.pig.builtin.DoubleAvg$Final
		approx_invocations=300
		approx_microsecs=85700
	org.apache.pig.builtin.DoubleAvg$Initial
		approx_invocations=8872200
		approx_microsecs=921000
	org.apache.pig.builtin.DoubleAvg$Intermediate
		approx_invocations=1200
		approx_microsecs=26025200
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=400
		approx_microsecs=234800
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=1600
		approx_microsecs=37928300
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=2925800
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=18300
42130 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q1.pig                                                                                      
           StartedAt: 2019-08-05 17:59:23                                                                                 
          FinishedAt: 2019-08-05 18:00:03                                                                                 
            Features: GROUP_BY,ORDER_BY,FILTER                                                                            

Success!


DAG 0:
                                    Name: PigLatin:Q1.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0025                                                                              
                      TotalLaunchedTasks: 8                                                                                                   
                           FileBytesRead: 3072                                                                                                
                        FileBytesWritten: 3596                                                                                                
                           HdfsBytesRead: 376276078                                                                                           
                        HdfsBytesWritten: 571                                                                                                 
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-106	->	Tez vertex scope-107,
Tez vertex scope-107	->	Tez vertex scope-117,Tez vertex scope-128,
Tez vertex scope-117	->	Tez vertex scope-128,
Tez vertex scope-128	->	Tez vertex scope-130,
Tez vertex scope-130

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-106          4          4        2999671                    0        2957127            256             1816      376276078                0 LineItems,PriceSummary,StatusGroup,SubLine,SubLineItems		
scope-107          1          1              0                   16              8           1774             1317              0                0 PriceSummary,SortedSummary	GROUP_BY,SAMPLER	
scope-117          1          1              0                    4              1            147               95              0                0 		
scope-128          1          1              5                    0              4            527              368              0                0 SortedSummary		
scope-130          1          1              0                    4              4            368                0              0              571 	ORDER_BY	/tpch-pig/out/Q1out,

Input(s):
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"

Output(s):
Successfully stored 4 records (571 bytes) in: "/tpch-pig/out/Q1out"

42153 [main] INFO  org.apache.pig.Main  - Pig script completed in 42 seconds and 305 milliseconds (42305 ms)
42153 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
42169 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@8ebc664
Q1 times (sec):	44

Clear buffer cache on HDFS cluster
Running Pig Query Q2
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q2.pig

60   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
61   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
944  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1071 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1557 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q2.pig-c75e3835-1317-43be-919b-26e5fcebbf17
1557 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2525 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_LONG 1 time(s).
2559 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER,LIMIT
2594 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2636 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2687 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2898 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp1291499646 and resources directory is /tmp/temp1291499646
2932 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3004 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-199 and vertex - scope-211
3094 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3138 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3152 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3204 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3210 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3210 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3232 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3239 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3240 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3263 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3269 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3270 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3294 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3301 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3302 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3731 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3731 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3731 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3731 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3947 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-190: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3947 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FR_N,FRegion,Region
3947 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: Region[11,9],Region[-1,-1],FRegion[13,10],FR_N[14,7]
3947 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3988 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-191: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3989 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FR_N,Nation
3989 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: Nation[9,9],Nation[-1,-1],FR_N[14,7]
3989 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4031 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-192: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4031 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FR_N,FR_N_S
4031 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: FR_N[14,7],FR_N_S[15,9]
4031 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-193: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FR_N_S,Supplier
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: Supplier[5,11],Supplier[-1,-1],FR_N_S[15,9]
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4107 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-194: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4107 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FR_N_S,FR_N_S_PS
4107 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: FR_N_S[15,9],FR_N_S_PS[16,12]
4107 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4131 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-195: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4131 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FR_N_S_PS,Partsupp
4131 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: Partsupp[7,11],Partsupp[-1,-1],FR_N_S_PS[16,12]
4131 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4162 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-196: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4162 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FR_N_S_PS,FR_N_S_PS_FP
4162 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: FR_N_S_PS[16,12],FR_N_S_PS_FP[19,15]
4162 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4188 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-197: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4189 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FPart,FR_N_S_PS_FP,Part
4189 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: Part[3,7],Part[-1,-1],FPart[18,8],FR_N_S_PS_FP[19,15]
4189 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4214 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-198: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4214 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: FR_N_S_PS_FP,G1
4214 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: FR_N_S_PS_FP[19,15],G1[21,5]
4215 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4247 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-199: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4247 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: Min,MinCost,RawResults,SortedMinimumCostSupplier
4248 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: Min[22,6],MinCost[23,10],RawResults[25,13],SortedMinimumCostSupplier[33,28]
4248 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-211: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4299 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-224: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4299 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: SortedMinimumCostSupplier
4299 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: SortedMinimumCostSupplier[33,28]
4299 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4331 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-226: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4331 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4331 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4331 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4364 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 13
4404 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
9084 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q2.pig-0_scope-0
9643 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q2.pig-0_scope-0. Application id: application_1564404443351_0026
10398 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0026
10644 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 13 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
23772 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 13 Succeeded: 13 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=Counters: 65
	org.apache.tez.common.counters.DAGCounter
		NUM_SUCCEEDED_TASKS=13
		TOTAL_LAUNCHED_TASKS=13
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=5
		AM_CPU_MILLISECONDS=3460
		AM_GC_TIME_MILLIS=53
	File System Counters
		FILE_BYTES_READ=95626423
		FILE_BYTES_WRITTEN=95677274
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=71511023
		HDFS_BYTES_WRITTEN=16061
		HDFS_READ_OPS=17
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		REDUCE_INPUT_GROUPS=46824
		REDUCE_INPUT_RECORDS=445647
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=930259
		NUM_SHUFFLED_INPUTS=13
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=11
		GC_TIME_MILLIS=1186
		CPU_MILLISECONDS=33510
		PHYSICAL_MEMORY_BYTES=11151605760
		VIRTUAL_MEMORY_BYTES=93207650304
		COMMITTED_HEAP_BYTES=11151605760
		INPUT_RECORDS_PROCESSED=505175
		INPUT_SPLIT_LENGTH_BYTES=71511023
		OUTPUT_RECORDS=445936
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=81097326
		OUTPUT_BYTES_WITH_OVERHEAD=78017478
		OUTPUT_BYTES_PHYSICAL=78017578
		ADDITIONAL_SPILLS_BYTES_WRITTEN=732483
		ADDITIONAL_SPILLS_BYTES_READ=95599113
		ADDITIONAL_SPILL_COUNT=1
		SHUFFLE_CHUNK_COUNT=11
		SHUFFLE_BYTES=78017530
		SHUFFLE_BYTES_DECOMPRESSED=78017478
		SHUFFLE_BYTES_TO_MEM=51395
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=77966135
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=424
		MERGE_PHASE_TIME=465
		FIRST_EVENT_RECEIVED=205
		LAST_EVENT_RECEIVED=205
	MultiStoreCounters
		Output records in _0_Q2out=100
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false','true','true','true')
		approx_invocations=100
		approx_microsecs=272000
	org.apache.pig.builtin.DoubleMin
		approx_invocations=200
		approx_microsecs=115200
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=696900
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=11400
24412 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q2.pig                                                                                      
           StartedAt: 2019-08-05 18:00:10                                                                                 
          FinishedAt: 2019-08-05 18:00:31                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER,LIMIT                                                            

Success!


DAG 0:
                                    Name: PigLatin:Q2.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0026                                                                              
                      TotalLaunchedTasks: 13                                                                                                  
                           FileBytesRead: 95626423                                                                                            
                        FileBytesWritten: 95677274                                                                                            
                           HdfsBytesRead: 71511023                                                                                            
                        HdfsBytesWritten: 16061                                                                                               
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-190	->	Tez vertex scope-192,
Tez vertex scope-191	->	Tez vertex scope-192,
Tez vertex scope-192	->	Tez vertex scope-194,
Tez vertex scope-193	->	Tez vertex scope-194,
Tez vertex scope-194	->	Tez vertex scope-196,
Tez vertex scope-195	->	Tez vertex scope-196,
Tez vertex scope-196	->	Tez vertex scope-198,
Tez vertex scope-197	->	Tez vertex scope-198,
Tez vertex scope-198	->	Tez vertex scope-199,
Tez vertex scope-199	->	Tez vertex scope-211,Tez vertex scope-224,
Tez vertex scope-211	->	Tez vertex scope-224,
Tez vertex scope-224	->	Tez vertex scope-226,
Tez vertex scope-226

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-190          1          1              5                    0              1             64              110            384                0 FR_N,FRegion,Region		
scope-191          1          1             25                    0             25             64             2422           2199                0 FR_N,Nation		
scope-192          1          1              0                   26              5           2564              901              0                0 FR_N,FR_N_S	HASH_JOIN	
scope-193          1          1           5000                    0           5000             64           747522         699860                0 FR_N_S,Supplier		
scope-194          1          1              0                 5005            973         748409           299648              0                0 FR_N_S,FR_N_S_PS	HASH_JOIN	
scope-195          1          1         400000                    0         400000             64         59151582       58864142                0 FR_N_S_PS,Partsupp		
scope-196          1          1              0               400973          38920       77059131         35215824              0                0 FR_N_S_PS,FR_N_S_PS_FP	HASH_JOIN	
scope-197          1          1         100000                    0            362             64            51349       11944438                0 FPart,FR_N_S_PS_FP,Part		
scope-198          1          1              0                39282            161       17659272           144749              0                0 FR_N_S_PS_FP,G1	HASH_JOIN	
scope-199          1          1              0                  161            244          93496            36817              0                0 Min,MinCost,RawResults,SortedMinimumCostSupplier	GROUP_BY,SAMPLER	
scope-211          1          1              0                  100              1          10608              141              0                0 		
scope-224          1          1            145                    0            144          26414            26209              0                0 SortedMinimumCostSupplier		
scope-226          1          1              0                  100            100          26209                0              0            16061 	ORDER_BY	/tpch-pig/out/Q2out,

Input(s):
Successfully read 5 records (384 bytes) from: "/tpch-pig/in/region"
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"
Successfully read 400000 records (58864142 bytes) from: "/tpch-pig/in/partsupp"
Successfully read 100000 records (11944438 bytes) from: "/tpch-pig/in/part"

Output(s):
Successfully stored 100 records (16061 bytes) in: "/tpch-pig/out/Q2out"

24436 [main] INFO  org.apache.pig.Main  - Pig script completed in 24 seconds and 593 milliseconds (24593 ms)
24436 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
24452 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@91dfe07
Q2 times (sec):	26

Clear buffer cache on HDFS cluster
Running Pig Query Q3
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q3.pig

66   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
67   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
975  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1565 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q3.pig-7686ff00-7fba-4ff9-bbff-9ed6d1878b11
1565 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2496 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2529 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER,LIMIT
2565 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2599 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2642 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2718 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $1, $2, $3, $4, $7, $8, $9, $11, $12, $13, $14, $15
2721 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $2, $3, $5, $6, $8
2722 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for customer: $1, $2, $3, $4, $5, $7
2850 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp699374447 and resources directory is /tmp/temp699374447
2882 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2936 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2960 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-125 and vertex - scope-135
3044 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3092 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3107 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3163 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3169 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3171 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3193 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3199 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3200 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3215 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-124 to 13
3612 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3613 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3613 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3613 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3832 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-120: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3832 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: flineitem,l1,lineitem
3832 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[8,11],lineitem[-1,-1],flineitem[13,12],flineitem[-1,-1],l1[18,5]
3832 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3878 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-121: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3878 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: forders,o1,orders
3878 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[6,9],orders[-1,-1],forders[12,10],o1[15,5]
3878 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3913 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-122: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3913 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: customer,fcustomer,o1
3914 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[4,11],customer[-1,-1],fcustomer[11,12],fcustomer[-1,-1],o1[15,5]
3914 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3954 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-123: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3955 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l1,o1,selo1
3955 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: o1[15,5],selo1[16,8],l1[18,5]
3955 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4012 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-124: parallelism=13, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4012 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: grResult,l1,sell1,sumResult
4012 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: l1[18,5],sell1[19,8],sumResult[22,12],grResult[21,11]
4013 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4041 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-125: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4042 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult,sumResult
4042 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sumResult[22,12],sortResult[23,13]
4042 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4080 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-135: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4081 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4081 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4081 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4103 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-146: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4104 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult
4104 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sortResult[23,13]
4104 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4135 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-148: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4135 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4135 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4135 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4172 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 24
4210 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8409 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q3.pig-0_scope-0
8893 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q3.pig-0_scope-0. Application id: application_1564404443351_0027
9204 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0027
9895 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 24 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
29895 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 24 Succeeded: 7 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
37053 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 24 Succeeded: 24 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 73
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=24
		TOTAL_LAUNCHED_TASKS=24
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=6
		AM_CPU_MILLISECONDS=3850
		AM_GC_TIME_MILLIS=64
	File System Counters
		FILE_BYTES_READ=52212535
		FILE_BYTES_WRITTEN=82636822
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=473456165
		HDFS_BYTES_WRITTEN=338
		HDFS_READ_OPS=15
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=565012
		REDUCE_INPUT_RECORDS=2038831
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=4081035
		NUM_SHUFFLED_INPUTS=84
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=82
		GC_TIME_MILLIS=2363
		CPU_MILLISECONDS=81070
		PHYSICAL_MEMORY_BYTES=23079682048
		VIRTUAL_MEMORY_BYTES=182880849920
		COMMITTED_HEAP_BYTES=23079682048
		INPUT_RECORDS_PROCESSED=3827624
		INPUT_SPLIT_LENGTH_BYTES=473456165
		OUTPUT_RECORDS=2049402
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=63520378
		OUTPUT_BYTES_WITH_OVERHEAD=52101152
		OUTPUT_BYTES_PHYSICAL=52101536
		ADDITIONAL_SPILLS_BYTES_WRITTEN=30499752
		ADDITIONAL_SPILLS_BYTES_READ=52010931
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=22
		SHUFFLE_BYTES=52101488
		SHUFFLE_BYTES_DECOMPRESSED=52101152
		SHUFFLE_BYTES_TO_MEM=30517439
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=21584049
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=2614
		MERGE_PHASE_TIME=3801
		FIRST_EVENT_RECEIVED=582
		LAST_EVENT_RECEIVED=1739
	MultiStoreCounters
		Output records in _0_Q3out=10
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=7605
		COMBINE_OUTPUT_RECORDS=2952
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false','true')
		approx_invocations=100
		approx_microsecs=303000
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=8300
		approx_microsecs=286400
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=3000
		approx_microsecs=38100
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=3900
		approx_microsecs=699000
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=2403700
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=17900
37219 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q3.pig                                                                                      
           StartedAt: 2019-08-05 18:00:38                                                                                 
          FinishedAt: 2019-08-05 18:01:12                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER,LIMIT                                                            

Success!


DAG 0:
                                    Name: PigLatin:Q3.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0027                                                                              
                      TotalLaunchedTasks: 24                                                                                                  
                           FileBytesRead: 52212535                                                                                            
                        FileBytesWritten: 82636822                                                                                            
                           HdfsBytesRead: 473456165                                                                                           
                        HdfsBytesWritten: 338                                                                                                 
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-120	->	Tez vertex scope-124,
Tez vertex scope-121	->	Tez vertex scope-123,
Tez vertex scope-122	->	Tez vertex scope-123,
Tez vertex scope-123	->	Tez vertex scope-124,
Tez vertex scope-124	->	Tez vertex scope-125,
Tez vertex scope-125	->	Tez vertex scope-135,Tez vertex scope-146,
Tez vertex scope-135	->	Tez vertex scope-146,
Tez vertex scope-146	->	Tez vertex scope-148,
Tez vertex scope-148

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-120          4          4        2999671                    0        1620297           2560         40915484      376276078                0 flineitem,l1,lineitem		
scope-121          1          1         750000                    0         363755             64          9569940       85109145                0 forders,o1,orders		
scope-122          1          1          75000                    0          15018             64           225312       12070942                0 customer,fcustomer,o1		
scope-123          1          1              0               378773          36699        9795828         10859909              0                0 l1,o1,selo1	HASH_JOIN	
scope-124         13         13              0              1656996           7618       42069995         20702240              0                0 grResult,l1,sell1,sumResult	HASH_JOIN	
scope-125          1          1              0                 2952           3052         125628           145494              0                0 sortResult,sumResult	GROUP_BY,SAMPLER	
scope-135          1          1              0                  100              1           5812             5923              0                0 		
scope-146          1          1           2953                    0           2952         106340           106276              0                0 sortResult		
scope-148          1          1              0                   10             10         106244           106244              0              338 	ORDER_BY	/tpch-pig/out/Q3out,

Input(s):
Successfully read 75000 records (12070942 bytes) from: "/tpch-pig/in/customer"
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"

Output(s):
Successfully stored 10 records (338 bytes) in: "/tpch-pig/out/Q3out"

37242 [main] INFO  org.apache.pig.Main  - Pig script completed in 37 seconds and 406 milliseconds (37406 ms)
37242 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
37256 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@45d75931
Q3 times (sec):	39

Clear buffer cache on HDFS cluster
Running Pig Query Q4
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q4.pig

60   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
61   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
924  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1043 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1561 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q4.pig-ef76ce95-8a95-4415-95b1-25913d6b6d26
1561 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2411 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_CHARARRAY 2 time(s).
2412 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_LONG 1 time(s).
2442 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: COGROUP,GROUP_BY,ORDER_BY,FILTER
2481 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2513 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2554 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2624 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for LineItem: $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $13, $14, $15
2767 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-1909995793 and resources directory is /tmp/temp-1909995793
2798 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2875 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-76 and vertex - scope-85
2978 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3021 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3038 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3099 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3106 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3107 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3126 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-75 to 4
3522 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3523 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3524 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3526 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3758 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-73: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3759 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG1,DateFilter,Orders
3759 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: Orders[3,9],DateFilter[7,13],Orders[-1,-1],COG1[11,7]
3759 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3801 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-74: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3802 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG1,CommitDateFilter,CommitDateFilter0,LineItem
3802 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: LineItem[5,11],CommitDateFilter0[8,20],CommitDateFilter[-1,-1],COG1[11,7]
3802 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3850 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-75: parallelism=4, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG1,Fil1,OrdersCount,PriorityChecking,PriorityGroup
3851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: COG1[-1,-1],Fil1[12,7],OrdersCount[14,14],PriorityChecking[16,19],PriorityGroup[15,16]
3851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: COGROUP
3902 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-76: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3902 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: PriorityChecking,SortedPriorityChecking
3902 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: PriorityChecking[16,19],SortedPriorityChecking[18,25]
3903 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
3943 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-85: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3943 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
3943 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
3943 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3965 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-95: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3965 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: SortedPriorityChecking
3966 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: SortedPriorityChecking[18,25]
3966 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3996 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-97: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3996 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
3997 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
3997 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4031 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 13
4069 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8210 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q4.pig-0_scope-0
8726 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q4.pig-0_scope-0. Application id: application_1564404443351_0028
9063 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0028
9728 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 13 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
26850 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 13 Succeeded: 13 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 75
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=13
		TOTAL_LAUNCHED_TASKS=14
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=5
		AM_CPU_MILLISECONDS=3200
		AM_GC_TIME_MILLIS=70
	File System Counters
		FILE_BYTES_READ=21093932
		FILE_BYTES_WRITTEN=30633526
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=461385223
		HDFS_BYTES_WRITTEN=72
		HDFS_READ_OPS=11
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=716356
		REDUCE_INPUT_RECORDS=1924365
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=3848730
		NUM_SHUFFLED_INPUTS=28
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=26
		GC_TIME_MILLIS=1745
		CPU_MILLISECONDS=62600
		PHYSICAL_MEMORY_BYTES=11207704576
		VIRTUAL_MEMORY_BYTES=93148434432
		COMMITTED_HEAP_BYTES=11207704576
		INPUT_RECORDS_PROCESSED=3749677
		INPUT_SPLIT_LENGTH_BYTES=461385223
		OUTPUT_RECORDS=1950521
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=31861433
		OUTPUT_BYTES_WITH_OVERHEAD=21072775
		OUTPUT_BYTES_PHYSICAL=21072935
		ADDITIONAL_SPILLS_BYTES_WRITTEN=9559863
		ADDITIONAL_SPILLS_BYTES_READ=21072541
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=11
		SHUFFLE_BYTES=21072887
		SHUFFLE_BYTES_DECOMPRESSED=21072775
		SHUFFLE_BYTES_TO_MEM=9560102
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=11512785
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=1606
		MERGE_PHASE_TIME=2711
		FIRST_EVENT_RECEIVED=441
		LAST_EVENT_RECEIVED=945
	MultiStoreCounters
		Output records in _0_Q4out=5
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=26161
		COMBINE_OUTPUT_RECORDS=20
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('true')
		approx_invocations=100
		approx_microsecs=190600
	org.apache.pig.builtin.COUNT
		approx_invocations=690400
		approx_microsecs=2615600
	org.apache.pig.builtin.COUNT$Final
		approx_invocations=100
		approx_microsecs=11900
	org.apache.pig.builtin.COUNT$Initial
		approx_invocations=26300
		approx_microsecs=233000
	org.apache.pig.builtin.COUNT$Intermediate
		approx_invocations=400
		approx_microsecs=241300
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1658800
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=9700
27076 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q4.pig                                                                                      
           StartedAt: 2019-08-05 18:01:19                                                                                 
          FinishedAt: 2019-08-05 18:01:43                                                                                 
            Features: COGROUP,GROUP_BY,ORDER_BY,FILTER                                                                    

Success!


DAG 0:
                                    Name: PigLatin:Q4.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0028                                                                              
                      TotalLaunchedTasks: 14                                                                                                  
                           FileBytesRead: 21093932                                                                                            
                        FileBytesWritten: 30633526                                                                                            
                           HdfsBytesRead: 461385223                                                                                           
                        HdfsBytesWritten: 72                                                                                                  
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-73	->	Tez vertex scope-75,
Tez vertex scope-74	->	Tez vertex scope-75,
Tez vertex scope-75	->	Tez vertex scope-76,
Tez vertex scope-76	->	Tez vertex scope-85,Tez vertex scope-95,
Tez vertex scope-85	->	Tez vertex scope-95,
Tez vertex scope-95	->	Tez vertex scope-97,
Tez vertex scope-97

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-73           1          1         750000                    0          28533            208          3764440       85109145                0 COG1,DateFilter,Orders		
scope-74           4          4        2999671                    0        1895802            832         17308050      376276078                0 COG1,CommitDateFilter,CommitDateFilter0,LineItem		
scope-75           4          4              0              1924335          26165       21091982          9559940              0                0 COG1,Fil1,OrdersCount,PriorityChecking,PriorityGroup	COGROUP	
scope-76           1          1              0                   20             10            410              563              0                0 PriorityChecking,SortedPriorityChecking	GROUP_BY,SAMPLER	
scope-85           1          1              0                    5              1            190              287              0                0 		
scope-95           1          1              6                    0              5            203              139              0                0 SortedPriorityChecking		
scope-97           1          1              0                    5              5            107              107              0               72 	ORDER_BY	/tpch-pig/out/Q4out,

Input(s):
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"

Output(s):
Successfully stored 5 records (72 bytes) in: "/tpch-pig/out/Q4out"

27099 [main] INFO  org.apache.pig.Main  - Pig script completed in 27 seconds and 273 milliseconds (27273 ms)
27099 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
27117 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@182f714e
Q4 times (sec):	29

Clear buffer cache on HDFS cluster
Running Pig Query Q5
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q5.pig

66   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
66   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
951  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1069 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1570 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q5.pig-028b07bf-1d9f-4a24-b770-56d477797a06
1571 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2644 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2681 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2726 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2774 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2827 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2920 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for customer: $1, $2, $4, $5, $6, $7
2923 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $2, $3, $5, $6, $7, $8
2923 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $1, $3, $4, $7, $8, $9, $10, $11, $12, $13, $14, $15
2924 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $1, $2, $4, $5, $6
2924 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for nation: $3
2925 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for region: $2
3068 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-1397692404 and resources directory is /tmp/temp-1397692404
3101 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3167 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3191 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-210 and vertex - scope-219
3276 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3320 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3336 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3389 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3395 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3396 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3418 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3424 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3425 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3447 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3453 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3455 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3473 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3478 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3479 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3516 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3525 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3526 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3542 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-209 to 11
3900 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3900 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3901 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3901 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
4112 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-199: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4113 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: c1,customer
4113 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[4,11],customer[-1,-1],c1[31,5]
4113 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4163 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-200: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4164 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: forders,o1,orders
4164 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[6,9],orders[-1,-1],forders[17,10],forders[-1,-1],o1[28,5]
4164 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4193 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-201: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4193 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l1,lineitem
4193 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[8,11],lineitem[-1,-1],l1[25,5]
4193 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4219 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-202: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4219 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: s1,supplier
4220 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[10,11],supplier[-1,-1],s1[22,5]
4220 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4248 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-203: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4248 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: n1,nation
4248 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation[12,9],nation[-1,-1],n1[19,5]
4248 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4276 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-204: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4277 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fregion,n1,region
4277 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: region[14,9],region[-1,-1],fregion[16,10],fregion[-1,-1],n1[19,5]
4277 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4313 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-205: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4313 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: n1,s1,seln1
4314 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: n1[19,5],seln1[20,8],s1[22,5]
4314 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4357 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-206: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4357 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l1,s1,sels1
4358 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: s1[22,5],sels1[23,8],l1[25,5]
4358 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4381 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-207: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4382 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l1,o1,sell1
4382 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: l1[25,5],sell1[26,8],o1[28,5]
4382 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4406 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-208: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4406 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: c1,o1,selo1
4406 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: o1[28,5],selo1[29,8],c1[31,5]
4406 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4436 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-209: parallelism=11, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4437 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: c1,grResult,selc1,sumResult
4437 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: c1[31,5],selc1[32,8],sumResult[35,12],grResult[34,11]
4437 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4464 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-210: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4464 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult,sumResult
4464 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sumResult[35,12],sortResult[36,13]
4465 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4505 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-219: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4505 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4506 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4506 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4527 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-229: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4528 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult
4528 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sortResult[36,13]
4528 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4556 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-231: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4557 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4557 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4557 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4588 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 28
4624 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
9293 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q5.pig-0_scope-0
9919 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q5.pig-0_scope-0. Application id: application_1564404443351_0029
10617 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0029
10922 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 28 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30922 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 28 Succeeded: 11 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
41123 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 28 Succeeded: 28 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 73
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=28
		TOTAL_LAUNCHED_TASKS=29
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=9
		AM_CPU_MILLISECONDS=4330
		AM_GC_TIME_MILLIS=59
	File System Counters
		FILE_BYTES_READ=99654701
		FILE_BYTES_WRITTEN=140607772
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=474158608
		HDFS_BYTES_WRITTEN=116
		HDFS_READ_OPS=21
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=493643
		REDUCE_INPUT_RECORDS=3547512
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=7095019
		NUM_SHUFFLED_INPUTS=48
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=46
		GC_TIME_MILLIS=2580
		CPU_MILLISECONDS=81660
		PHYSICAL_MEMORY_BYTES=32567197696
		VIRTUAL_MEMORY_BYTES=206633631744
		COMMITTED_HEAP_BYTES=32567197696
		INPUT_RECORDS_PROCESSED=3829707
		INPUT_SPLIT_LENGTH_BYTES=474158608
		OUTPUT_RECORDS=3548390
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=125684074
		OUTPUT_BYTES_WITH_OVERHEAD=99738531
		OUTPUT_BYTES_PHYSICAL=99738771
		ADDITIONAL_SPILLS_BYTES_WRITTEN=40867673
		ADDITIONAL_SPILLS_BYTES_READ=99608385
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=26
		SHUFFLE_BYTES=99738723
		SHUFFLE_BYTES_DECOMPRESSED=99738531
		SHUFFLE_BYTES_TO_MEM=40997880
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=58740843
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=3814
		MERGE_PHASE_TIME=4836
		FIRST_EVENT_RECEIVED=576
		LAST_EVENT_RECEIVED=2898
	MultiStoreCounters
		Output records in _0_Q5out=5
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=911
		COMBINE_OUTPUT_RECORDS=55
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false')
		approx_invocations=100
		approx_microsecs=152600
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=1100
		approx_microsecs=200900
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=100
		approx_microsecs=9000
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=1100
		approx_microsecs=671200
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1978700
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=7000
41634 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q5.pig                                                                                      
           StartedAt: 2019-08-05 18:01:51                                                                                 
          FinishedAt: 2019-08-05 18:02:29                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q5.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0029                                                                              
                      TotalLaunchedTasks: 29                                                                                                  
                           FileBytesRead: 99654701                                                                                            
                        FileBytesWritten: 140607772                                                                                           
                           HdfsBytesRead: 474158608                                                                                           
                        HdfsBytesWritten: 116                                                                                                 
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-199	->	Tez vertex scope-209,
Tez vertex scope-200	->	Tez vertex scope-208,
Tez vertex scope-201	->	Tez vertex scope-207,
Tez vertex scope-202	->	Tez vertex scope-206,
Tez vertex scope-203	->	Tez vertex scope-205,
Tez vertex scope-204	->	Tez vertex scope-205,
Tez vertex scope-205	->	Tez vertex scope-206,
Tez vertex scope-206	->	Tez vertex scope-207,
Tez vertex scope-207	->	Tez vertex scope-208,
Tez vertex scope-208	->	Tez vertex scope-209,
Tez vertex scope-209	->	Tez vertex scope-210,
Tez vertex scope-210	->	Tez vertex scope-219,Tez vertex scope-229,
Tez vertex scope-219	->	Tez vertex scope-229,
Tez vertex scope-229	->	Tez vertex scope-231,
Tez vertex scope-231

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-199          1          1          75000                    0          75000            544          1053750       12070942                0 c1,customer		
scope-200          1          1         750000                    0         113997             64          2229992       85109145                0 forders,o1,orders		
scope-201          4          4        2999671                    0        2999671            256         81445234      376276078                0 l1,lineitem		
scope-202          1          1           5000                    0           5000             64            35139         699860                0 s1,supplier		
scope-203          1          1             25                    0             25             64              487           2199                0 n1,nation		
scope-204          1          1              5                    0              1             64               53            384                0 fregion,n1,region		
scope-205          1          1              0                   26              5            604              143              0                0 n1,s1,seln1	HASH_JOIN	
scope-206          1          1              0                 5005           1023          35346            26783              0                0 l1,s1,sels1	HASH_JOIN	
scope-207          1          1              0              3000694         306198       81342007         53597486              0                0 l1,o1,sell1	HASH_JOIN	
scope-208          1          1              0               420195          46527       15236172          1940467              0                0 c1,o1,selo1	HASH_JOIN	
scope-209         11         11              0               121527            922        3037298           277319              0                0 c1,grResult,selc1,sumResult	HASH_JOIN	
scope-210          1          1              0                   55             10           1694              361              0                0 sortResult,sumResult	GROUP_BY,SAMPLER	
scope-219          1          1              0                    5              1            166              264              0                0 		
scope-229          1          1              6                    0              5            227              163              0                0 sortResult		
scope-231          1          1              0                    5              5            131              131              0              116 	ORDER_BY	/tpch-pig/out/Q5out,

Input(s):
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 75000 records (12070942 bytes) from: "/tpch-pig/in/customer"
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 5 records (384 bytes) from: "/tpch-pig/in/region"
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"

Output(s):
Successfully stored 5 records (116 bytes) in: "/tpch-pig/out/Q5out"

41658 [main] INFO  org.apache.pig.Main  - Pig script completed in 41 seconds and 813 milliseconds (41813 ms)
41658 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
41673 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@312a27f0
Q5 times (sec):	43

Clear buffer cache on HDFS cluster
Running Pig Query Q6
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q6.pig

64   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
65   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
964  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1075 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1587 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q6.pig-11606d42-474f-4389-b087-02748538ad8a
1587 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2349 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_CHARARRAY 2 time(s).
2349 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 4 time(s).
2349 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_INT 1 time(s).
2382 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: GROUP_BY,FILTER
2420 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2452 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2491 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $0, $1, $2, $3, $7, $8, $9, $11, $12, $13, $14, $15
2537 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2637 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-1018173649 and resources directory is /tmp/temp-1018173649
2668 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2706 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2810 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
2852 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
2867 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3287 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3288 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3288 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3288 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3586 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-43: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3587 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: flineitem,grpResult,lineitem,saving,sumResult
3587 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[4,11],flineitem[7,12],saving[-1,-1],sumResult[11,12],grpResult[10,12]
3587 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3643 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-44: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3643 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sumResult
3644 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sumResult[11,12]
3644 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
3716 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 5
3753 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8443 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q6.pig-0_scope-0
8872 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q6.pig-0_scope-0. Application id: application_1564404443351_0030
9747 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0030
9874 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 5 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
22195 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 5 Succeeded: 5 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=Counters: 68
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=1
		NUM_SUCCEEDED_TASKS=5
		TOTAL_LAUNCHED_TASKS=5
		DATA_LOCAL_TASKS=4
		AM_CPU_MILLISECONDS=2580
		AM_GC_TIME_MILLIS=48
	File System Counters
		FILE_BYTES_READ=429
		FILE_BYTES_WRITTEN=299
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=376276078
		HDFS_BYTES_WRITTEN=21
		HDFS_READ_OPS=7
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=1
		REDUCE_INPUT_GROUPS=1
		REDUCE_INPUT_RECORDS=4
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=8
		NUM_SHUFFLED_INPUTS=4
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=4
		GC_TIME_MILLIS=1145
		CPU_MILLISECONDS=34520
		PHYSICAL_MEMORY_BYTES=5028446208
		VIRTUAL_MEMORY_BYTES=28918288384
		COMMITTED_HEAP_BYTES=5028446208
		INPUT_RECORDS_PROCESSED=2999671
		INPUT_SPLIT_LENGTH_BYTES=376276078
		OUTPUT_RECORDS=57302
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=1088719
		OUTPUT_BYTES_WITH_OVERHEAD=108
		OUTPUT_BYTES_PHYSICAL=124
		ADDITIONAL_SPILLS_BYTES_WRITTEN=47
		ADDITIONAL_SPILLS_BYTES_READ=109
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=4
		SHUFFLE_BYTES=124
		SHUFFLE_BYTES_DECOMPRESSED=108
		SHUFFLE_BYTES_TO_MEM=62
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=62
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=133
		MERGE_PHASE_TIME=161
		FIRST_EVENT_RECEIVED=53
		LAST_EVENT_RECEIVED=63
	MultiStoreCounters
		Output records in _0_Q6out=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=57297
		COMBINE_OUTPUT_RECORDS=4
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=57400
		approx_microsecs=351500
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=100
		approx_microsecs=261300
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=400
		approx_microsecs=4932700
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1595100
22758 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q6.pig                                                                                      
           StartedAt: 2019-08-05 18:02:36                                                                                 
          FinishedAt: 2019-08-05 18:02:56                                                                                 
            Features: GROUP_BY,FILTER                                                                                     

Success!


DAG 0:
                                    Name: PigLatin:Q6.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0030                                                                              
                      TotalLaunchedTasks: 5                                                                                                   
                           FileBytesRead: 429                                                                                                 
                        FileBytesWritten: 299                                                                                                 
                           HdfsBytesRead: 376276078                                                                                           
                        HdfsBytesWritten: 21                                                                                                  
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-43	->	Tez vertex scope-44,
Tez vertex scope-44

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-43           4          4        2999671                    0          57301            256              252      376276078                0 flineitem,grpResult,lineitem,saving,sumResult		
scope-44           1          1              0                    4              1            173               47              0               21 sumResult	GROUP_BY	/tpch-pig/out/Q6out,

Input(s):
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"

Output(s):
Successfully stored 1 records (21 bytes) in: "/tpch-pig/out/Q6out"

22782 [main] INFO  org.apache.pig.Main  - Pig script completed in 22 seconds and 939 milliseconds (22939 ms)
22782 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
22803 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@d02ee9e
Q6 times (sec):	24

Clear buffer cache on HDFS cluster
Running Pig Query Q7
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q7.pig

65   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
66   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
947  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1057 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1539 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q7.pig-c6373ed5-b189-4797-8c79-cc07eaecfdf1
1539 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2567 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2615 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: REPLICATED_JOIN,HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2664 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2704 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2750 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2848 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $2, $3, $4, $5, $6, $7, $8
2851 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for customer: $1, $2, $4, $5, $6, $7
2851 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $1, $2, $4, $5, $6
2852 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem0: $1, $3, $4, $7, $8, $9, $11, $12, $13, $14, $15
2853 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for nation20: $2, $3
2853 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for nation10: $2, $3
3036 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-203995526 and resources directory is /tmp/temp-203995526
3068 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3123 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3144 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-229 and vertex - scope-240
3222 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3260 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3327 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3333 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3335 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3358 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3364 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3365 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3410 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3415 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3415 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3432 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3437 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3438 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3454 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3459 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3462 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3474 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-228 to 20
3820 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3820 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3820 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3820 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
4053 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-221: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4053 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: nation2,nation20
4053 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation20[14,11],nation20[-1,-1],nation2[17,10]
4054 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4099 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-220: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4099 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: customer,customer_nation2,orders_customer_nation2
4099 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[9,11],customer[-1,-1],customer_nation2[25,19],customer_nation2[-1,-1],orders_customer_nation2[27,26]
4099 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: REPLICATED_JOIN
4150 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-222: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4150 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: orders,orders_customer_nation2
4151 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[7,9],orders[-1,-1],orders_customer_nation2[27,26]
4151 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4196 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-223: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4197 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: final_join,orders_customer_nation2
4197 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders_customer_nation2[27,26],orders_customer_nation2[-1,-1],final_join[29,13]
4197 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4231 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-225: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4231 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: nation1,nation10
4231 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation10[12,11],nation10[-1,-1],nation1[16,10]
4231 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4259 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-224: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4259 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: liteitem_supplier_nation1,supplier,supplier_nation1
4259 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[3,11],supplier[-1,-1],supplier_nation1[21,19],supplier_nation1[-1,-1],liteitem_supplier_nation1[23,28]
4259 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: REPLICATED_JOIN
4290 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-226: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4291 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: lineitem,lineitem0,liteitem_supplier_nation1
4291 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem0[5,12],lineitem0[-1,-1],lineitem[19,11],liteitem_supplier_nation1[23,28]
4291 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4318 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-227: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4318 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: final_join,liteitem_supplier_nation1
4318 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: liteitem_supplier_nation1[23,28],liteitem_supplier_nation1[-1,-1],final_join[29,13]
4318 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4353 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-228: parallelism=20, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4353 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: aggregated_shipping,filtered_final_join,final_join,grouped_shipping,shipping
4353 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: final_join[29,13],final_join[-1,-1],filtered_final_join[31,22],shipping[35,11],aggregated_shipping[41,22],grouped_shipping[40,19]
4354 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4380 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-229: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4380 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: aggregated_shipping,ordered_shipping
4381 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: aggregated_shipping[41,22],ordered_shipping[43,19]
4381 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4415 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-240: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4416 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4416 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4416 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4436 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-252: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4437 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: ordered_shipping
4437 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: ordered_shipping[43,19]
4437 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4466 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-254: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4466 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4466 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4466 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4502 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 35
4542 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
9264 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q7.pig-0_scope-0
9851 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q7.pig-0_scope-0. Application id: application_1564404443351_0031
10536 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0031
10854 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 35 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30854 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 35 Succeeded: 15 Running: 2 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
36009 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 35 Succeeded: 35 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 77
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=35
		TOTAL_LAUNCHED_TASKS=36
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=9
		AM_CPU_MILLISECONDS=4320
		AM_GC_TIME_MILLIS=72
	File System Counters
		FILE_BYTES_READ=48068165
		FILE_BYTES_WRITTEN=66661303
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=474160423
		HDFS_BYTES_WRITTEN=147
		HDFS_READ_OPS=21
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=180932
		REDUCE_INPUT_RECORDS=1738936
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=3477872
		NUM_SHUFFLED_INPUTS=73
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=69
		GC_TIME_MILLIS=1717
		CPU_MILLISECONDS=75200
		PHYSICAL_MEMORY_BYTES=32902217728
		VIRTUAL_MEMORY_BYTES=265801084928
		COMMITTED_HEAP_BYTES=32902217728
		INPUT_RECORDS_PROCESSED=3829730
		INPUT_SPLIT_LENGTH_BYTES=474160423
		OUTPUT_RECORDS=1739668
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=61143753
		OUTPUT_BYTES_WITH_OVERHEAD=48090786
		OUTPUT_BYTES_PHYSICAL=48091174
		ADDITIONAL_SPILLS_BYTES_WRITTEN=18568193
		ADDITIONAL_SPILLS_BYTES_READ=47958239
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=31
		SHUFFLE_BYTES=48091078
		SHUFFLE_BYTES_DECOMPRESSED=48090786
		SHUFFLE_BYTES_TO_MEM=18700850
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=29390228
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=2376
		MERGE_PHASE_TIME=2525
		FIRST_EVENT_RECEIVED=945
		LAST_EVENT_RECEIVED=984
	MultiInputCounters
		Input records from _0_customer=75000
		Input records from _0_supplier=5000
	MultiStoreCounters
		Output records in _0_Q7out=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=779
		COMBINE_OUTPUT_RECORDS=80
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('true','true','true')
		approx_invocations=100
		approx_microsecs=161000
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=2000
		approx_microsecs=69100
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=100
		approx_microsecs=215800
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=2000
		approx_microsecs=618000
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=2116300
	org.apache.pig.builtin.SUBSTRING
		approx_invocations=2000
		approx_microsecs=157900
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=13200
36553 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q7.pig                                                                                      
           StartedAt: 2019-08-05 18:03:03                                                                                 
          FinishedAt: 2019-08-05 18:03:37                                                                                 
            Features: REPLICATED_JOIN,HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q7.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0031                                                                              
                      TotalLaunchedTasks: 36                                                                                                  
                           FileBytesRead: 48068165                                                                                            
                        FileBytesWritten: 66661303                                                                                            
                           HdfsBytesRead: 474160423                                                                                           
                        HdfsBytesWritten: 147                                                                                                 
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-221	->	Tez vertex scope-220,
Tez vertex scope-220	->	Tez vertex scope-223,
Tez vertex scope-222	->	Tez vertex scope-223,
Tez vertex scope-223	->	Tez vertex scope-228,
Tez vertex scope-225	->	Tez vertex scope-224,
Tez vertex scope-224	->	Tez vertex scope-227,
Tez vertex scope-226	->	Tez vertex scope-227,
Tez vertex scope-227	->	Tez vertex scope-228,
Tez vertex scope-228	->	Tez vertex scope-229,
Tez vertex scope-229	->	Tez vertex scope-240,Tez vertex scope-252,
Tez vertex scope-240	->	Tez vertex scope-252,
Tez vertex scope-252	->	Tez vertex scope-254,
Tez vertex scope-254

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-220          1          1          75002                    0           5978             64           146486       12070942                0 customer,customer_nation2,orders_customer_nation2	REPLICATED_JOIN	
scope-221          1          1             25                    0              2              0               83           2199                0 nation2,nation20		
scope-222          1          1         750000                    0         750000             64          8026013       85109145                0 orders,orders_customer_nation2		
scope-223          1          1              0               755978          30426        8173443           892523              0                0 final_join,orders_customer_nation2	HASH_JOIN	
scope-224          1          1           5002                    0            411             64            10118         699860                0 liteitem_supplier_nation1,supplier,supplier_nation1	REPLICATED_JOIN	
scope-225          1          1             25                    0              2              0               83           2199                0 nation1,nation10		
scope-226          4          4        2999671                    0         914862            256         37094782      376276078                0 lineitem,lineitem0,liteitem_supplier_nation1		
scope-227          1          1              0               915273          37171       36975802         20484290              0                0 final_join,liteitem_supplier_nation1	HASH_JOIN	
scope-228         20         20              0                67597            799        2916415             4360              0                0 aggregated_shipping,filtered_final_join,final_join,grouped_shipping,shipping	HASH_JOIN	
scope-229          1          1              0                   80              8           1322             1779              0                0 aggregated_shipping,ordered_shipping	GROUP_BY,SAMPLER	
scope-240          1          1              0                    4              1            275              390              0                0 		
scope-252          1          1              5                    0              4            278              214              0                0 ordered_shipping		
scope-254          1          1              0                    4              4            182              182              0              147 	ORDER_BY	/tpch-pig/out/Q7out,

Input(s):
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"
Successfully read 75000 records (12070942 bytes) from: "/tpch-pig/in/customer"

Output(s):
Successfully stored 4 records (147 bytes) in: "/tpch-pig/out/Q7out"

36576 [main] INFO  org.apache.pig.Main  - Pig script completed in 36 seconds and 738 milliseconds (36738 ms)
36576 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
36595 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@8d25f20
Q7 times (sec):	38

Clear buffer cache on HDFS cluster
Running Pig Query Q8
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q8.pig

63   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
64   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
946  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1066 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1583 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q8.pig-eb352f59-f58c-4b67-9705-a8ec3e5e3d8e
1584 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2667 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 2 time(s).
2704 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: REPLICATED_JOIN,HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2748 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2788 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2836 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2955 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $2, $3, $5, $6, $7, $8
2958 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $1, $2, $4, $5, $6
2959 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for nation: $3
2959 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for customer: $1, $2, $4, $5, $6, $7
2960 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for part: $1, $2, $3, $5, $6, $7, $8
2960 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $3, $4, $7, $8, $9, $10, $11, $12, $13, $14, $15
2961 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for region: $2
3133 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp191440682 and resources directory is /tmp/temp191440682
3170 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3230 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3258 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-264 and vertex - scope-273
3365 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3405 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3418 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3465 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3470 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3471 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3492 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3497 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3497 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3517 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3523 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3523 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3542 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3548 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3549 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3564 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3569 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3572 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3592 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3598 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3598 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3611 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-263 to 20
3951 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3951 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3951 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3951 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
4168 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-248: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4168 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: forders,o1,orders
4169 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[6,9],orders[-1,-1],forders[18,10],o1[27,5]
4169 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4217 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-254: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4217 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fregion,region
4217 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: region[14,9],region[-1,-1],fregion[17,10],fregion[-1,-1]
4217 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4261 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-250: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4261 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: n1,nation,seln1
4261 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation[12,9],nation[-1,-1],nation[-1,-1],n1[21,5],seln1[22,8],nation[-1,-1]
4262 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: MULTI_QUERY
4321 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-249: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4322 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: c1,customer,o1,selc1
4322 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[4,11],customer[-1,-1],c1[24,5],selc1[25,8],o1[27,5]
4322 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: REPLICATED_JOIN
4372 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-255: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4372 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l1,o1
4373 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: o1[27,5],o1[-1,-1],l1[37,5]
4373 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4399 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-256: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4400 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: n2,s1,supplier
4400 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[10,11],supplier[-1,-1],n2[30,5],n2[-1,-1],s1[35,5]
4400 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: REPLICATED_JOIN
4431 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-259: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4432 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fpart,p1,part
4432 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: part[16,7],part[-1,-1],fpart[19,8],fpart[-1,-1],p1[33,5]
4432 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4463 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-260: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4463 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: lineitem,p1
4464 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[8,11],lineitem[-1,-1],p1[33,5]
4464 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4504 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-261: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4504 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: p1,s1
4505 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: p1[33,5],p1[-1,-1],s1[35,5]
4505 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4541 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-262: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4542 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l1,s1
4542 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: s1[35,5],s1[-1,-1],l1[37,5]
4542 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4578 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-263: parallelism=20, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4578 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: grResult,l1,sels1,sumResult
4578 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: l1[37,5],sels1[39,8],sumResult[42,12],grResult[40,11]
4578 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4607 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-264: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4608 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult,sumResult
4608 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sumResult[42,12],sortResult[43,13]
4608 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4647 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-273: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4647 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4647 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4647 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4669 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-283: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4669 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult
4669 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sortResult[43,13]
4669 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4698 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-285: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4698 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4698 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4698 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4733 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 37
4770 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8943 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q8.pig-0_scope-0
9580 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q8.pig-0_scope-0. Application id: application_1564404443351_0032
9764 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0032
10581 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 37 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30581 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 37 Succeeded: 10 Running: 2 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
38730 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 37 Succeeded: 37 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 78
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=37
		TOTAL_LAUNCHED_TASKS=38
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=10
		AM_CPU_MILLISECONDS=4500
		AM_GC_TIME_MILLIS=54
	File System Counters
		FILE_BYTES_READ=78079669
		FILE_BYTES_WRITTEN=121263405
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=486103046
		HDFS_BYTES_WRITTEN=51
		HDFS_READ_OPS=25
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=338412
		REDUCE_INPUT_RECORDS=3288471
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=6576942
		NUM_SHUFFLED_INPUTS=76
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=71
		GC_TIME_MILLIS=2010
		CPU_MILLISECONDS=87130
		PHYSICAL_MEMORY_BYTES=39655047168
		VIRTUAL_MEMORY_BYTES=279366090752
		COMMITTED_HEAP_BYTES=39655047168
		INPUT_RECORDS_PROCESSED=3929735
		INPUT_SPLIT_LENGTH_BYTES=486103046
		OUTPUT_RECORDS=3288615
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=98360069
		OUTPUT_BYTES_WITH_OVERHEAD=80427310
		OUTPUT_BYTES_PHYSICAL=80427734
		ADDITIONAL_SPILLS_BYTES_WRITTEN=40833663
		ADDITIONAL_SPILLS_BYTES_READ=78016888
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=33
		SHUFFLE_BYTES=80427614
		SHUFFLE_BYTES_DECOMPRESSED=80427310
		SHUFFLE_BYTES_TO_MEM=43244272
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=37183342
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=6530
		MERGE_PHASE_TIME=5926
		FIRST_EVENT_RECEIVED=1615
		LAST_EVENT_RECEIVED=4052
	MultiInputCounters
		Input records from _0_customer=75000
		Input records from _0_nation=25
		Input records from _0_supplier=5000
	MultiStoreCounters
		Output records in _0_Q8out=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=123
		COMBINE_OUTPUT_RECORDS=35
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('true')
		approx_invocations=100
		approx_microsecs=222800
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=4000
		approx_microsecs=95600
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=200
		approx_microsecs=18900
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=4000
		approx_microsecs=716300
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=2412700
	org.apache.pig.builtin.SUBSTRING
		approx_invocations=2000
		approx_microsecs=158100
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=9300
39790 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q8.pig                                                                                      
           StartedAt: 2019-08-05 18:03:44                                                                                 
          FinishedAt: 2019-08-05 18:04:20                                                                                 
            Features: REPLICATED_JOIN,HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q8.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0032                                                                              
                      TotalLaunchedTasks: 38                                                                                                  
                           FileBytesRead: 78079669                                                                                            
                        FileBytesWritten: 121263405                                                                                           
                           HdfsBytesRead: 486103046                                                                                           
                        HdfsBytesWritten: 51                                                                                                  
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-248	->	Tez vertex scope-255,
Tez vertex scope-254	->	Tez vertex scope-250,
Tez vertex scope-250	->	Tez vertex scope-249,Tez vertex scope-256,
Tez vertex scope-249	->	Tez vertex scope-255,
Tez vertex scope-255	->	Tez vertex scope-263,
Tez vertex scope-256	->	Tez vertex scope-262,
Tez vertex scope-259	->	Tez vertex scope-261,
Tez vertex scope-260	->	Tez vertex scope-261,
Tez vertex scope-261	->	Tez vertex scope-262,
Tez vertex scope-262	->	Tez vertex scope-263,
Tez vertex scope-263	->	Tez vertex scope-264,
Tez vertex scope-264	->	Tez vertex scope-273,Tez vertex scope-283,
Tez vertex scope-273	->	Tez vertex scope-283,
Tez vertex scope-283	->	Tez vertex scope-285,
Tez vertex scope-285

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-248          1          1         750000                    0         228641             64          6105634       85109145                0 forders,o1,orders		
scope-249          1          1          75005                    0          15048            161           225762       12070942                0 c1,customer,o1,selc1	REPLICATED_JOIN	
scope-250          1          1             26                    0             30              0              666           2199                0 n1,nation,seln1	MULTI_QUERY	
scope-254          1          1              5                    0              1              0               53            384                0 fregion,region		
scope-255          1          1              0               243689          22903        6332340          6747574              0                0 l1,o1	HASH_JOIN	
scope-256          1          1           5025                    0           5000             64           125220         699860                0 n2,s1,supplier	REPLICATED_JOIN	
scope-259          1          1         100000                    0            718             64            10812       11944438                0 fpart,p1,part		
scope-260          4          4        2999671                    0        2999671            256         72902036      376276078                0 lineitem,p1		
scope-261          1          1              0              3000389          10950       70503101         34230961              0                0 p1,s1	HASH_JOIN	
scope-262          1          1              0                15950           5501         354426           540422              0                0 l1,s1	HASH_JOIN	
scope-263         20         20              0                28404            143         887496           373277              0                0 grResult,l1,sels1,sumResult	HASH_JOIN	
scope-264          1          1              0                   35              4           1432              691              0                0 sortResult,sumResult	GROUP_BY,SAMPLER	
scope-273          1          1              0                    2              1             65              161              0                0 		
scope-283          1          1              3                    0              2            148               84              0                0 sortResult		
scope-285          1          1              0                    2              2             52               52              0               51 	ORDER_BY	/tpch-pig/out/Q8out,

Input(s):
Successfully read 5 records (384 bytes) from: "/tpch-pig/in/region"
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 100000 records (11944438 bytes) from: "/tpch-pig/in/part"
Successfully read 75000 records (12070942 bytes) from: "/tpch-pig/in/customer"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"

Output(s):
Successfully stored 2 records (51 bytes) in: "/tpch-pig/out/Q8out"

39813 [main] INFO  org.apache.pig.Main  - Pig script completed in 39 seconds and 996 milliseconds (39996 ms)
39824 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
39840 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@711d7bed
Q8 times (sec):	42

Clear buffer cache on HDFS cluster
Running Pig Query Q9
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q9.pig

64   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
65   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
957  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1071 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1555 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q9.pig-db6337b1-969f-48e0-a9d5-80215368fec9
1556 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2714 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2751 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: REPLICATED_JOIN,HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2794 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2835 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2882 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2962 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $1, $2, $3, $5, $6, $7, $8
2965 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for partsupp: $2, $4
2966 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $1, $2, $4, $5, $6
2966 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for nation: $2, $3
2967 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $3, $7, $8, $9, $10, $11, $12, $13, $14, $15
2968 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for part: $2, $3, $4, $5, $6, $7, $8
3118 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-1227461283 and resources directory is /tmp/temp-1227461283
3154 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3214 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3236 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-224 and vertex - scope-234
3333 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3373 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3387 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3438 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3444 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3444 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3466 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3472 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3473 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3493 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3499 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3500 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3520 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3526 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3529 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3548 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3557 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3557 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3572 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-223 to 11
3906 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3906 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3906 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3907 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
4113 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-214: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4113 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j4,partsupp
4114 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: partsupp[16,11],partsupp[-1,-1],j4[28,5]
4114 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4152 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-216: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4152 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: nation
4152 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation[12,9],nation[-1,-1]
4152 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4188 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-215: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4188 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j2,j3,supplier
4189 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[10,11],supplier[-1,-1],j2[24,5],j2[-1,-1],j3[26,5]
4189 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: REPLICATED_JOIN
4247 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-217: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4247 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fpart,j1,part
4247 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: part[18,7],part[-1,-1],fpart[20,8],fpart[-1,-1],j1[22,5]
4247 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-218: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j1,lineitem
4275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[8,11],lineitem[-1,-1],j1[22,5]
4275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4311 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-219: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4311 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j1,j3
4311 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: j1[22,5],j1[-1,-1],j3[26,5]
4311 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4335 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-220: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4335 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j3,j4
4335 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: j3[26,5],j3[-1,-1],j4[28,5]
4336 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4362 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-221: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4362 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j4,j5
4362 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: j4[28,5],j4[-1,-1],j5[30,5]
4362 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4384 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-222: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4384 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j5,orders
4385 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[6,9],orders[-1,-1],j5[30,5]
4385 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4418 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-223: parallelism=11, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4418 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: grResult,j5,selo1,sumResult
4418 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: j5[30,5],selo1[32,8],sumResult[36,12],grResult[34,11]
4418 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4444 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-224: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4445 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult,sumResult
4445 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sumResult[36,12],sortResult[37,13]
4445 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4481 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-234: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4481 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4482 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4482 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4503 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-245: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4503 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult
4504 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sortResult[37,13]
4504 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4533 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-247: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4534 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4534 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4534 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4568 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 27
4606 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
9296 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q9.pig-0_scope-0
9901 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q9.pig-0_scope-0. Application id: application_1564404443351_0033
10598 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0033
10904 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 27 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30904 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 27 Succeeded: 9 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
46076 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 27 Succeeded: 27 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 80
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=27
		TOTAL_LAUNCHED_TASKS=27
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=9
		AM_CPU_MILLISECONDS=4500
		AM_GC_TIME_MILLIS=89
	File System Counters
		FILE_BYTES_READ=166378629
		FILE_BYTES_WRITTEN=217515616
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=532895862
		HDFS_BYTES_WRITTEN=4964
		HDFS_READ_OPS=24
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=1423845
		REDUCE_INPUT_RECORDS=4336779
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=8673383
		NUM_SHUFFLED_INPUTS=47
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=44
		GC_TIME_MILLIS=2396
		CPU_MILLISECONDS=100380
		PHYSICAL_MEMORY_BYTES=27522498560
		VIRTUAL_MEMORY_BYTES=198355849216
		COMMITTED_HEAP_BYTES=27522498560
		INPUT_RECORDS_PROCESSED=4254897
		INPUT_SPLIT_LENGTH_BYTES=532895862
		OUTPUT_RECORDS=4378610
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=183218158
		OUTPUT_BYTES_WITH_OVERHEAD=166354964
		OUTPUT_BYTES_PHYSICAL=166355224
		ADDITIONAL_SPILLS_BYTES_WRITTEN=51159120
		ADDITIONAL_SPILLS_BYTES_READ=166342418
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=24
		SHUFFLE_BYTES=166355152
		SHUFFLE_BYTES_DECOMPRESSED=166354964
		SHUFFLE_BYTES_TO_MEM=51165269
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=115189883
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=2792
		MERGE_PHASE_TIME=3888
		FIRST_EVENT_RECEIVED=597
		LAST_EVENT_RECEIVED=1824
	MultiInputCounters
		Input records from _0_supplier=5000
	MultiStoreCounters
		Output records in _0_Q9out=175
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=43369
		COMBINE_OUTPUT_RECORDS=1925
	org.apache.pig.PigWarning
		UDF_WARNING_1=94158
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('true','false')
		approx_invocations=100
		approx_microsecs=376500
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=43900
		approx_microsecs=183300
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=200
		approx_microsecs=14700
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=2200
		approx_microsecs=720100
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=2891600
	org.apache.pig.builtin.REGEX_EXTRACT
		UDF_WARNING_1=94158
		approx_invocations=100000
		approx_microsecs=494500
	org.apache.pig.builtin.SUBSTRING
		approx_invocations=43900
		approx_microsecs=666700
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=16100
46606 [main] WARN  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Encountered Warning UDF_WARNING_1 94158 time(s).
46616 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q9.pig                                                                                      
           StartedAt: 2019-08-05 18:04:28                                                                                 
          FinishedAt: 2019-08-05 18:05:11                                                                                 
            Features: REPLICATED_JOIN,HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q9.pig-0_scope-0                                                                           
                           ApplicationId: job_1564404443351_0033                                                                              
                      TotalLaunchedTasks: 27                                                                                                  
                           FileBytesRead: 166378629                                                                                           
                        FileBytesWritten: 217515616                                                                                           
                           HdfsBytesRead: 532895862                                                                                           
                        HdfsBytesWritten: 4964                                                                                                
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-214	->	Tez vertex scope-221,
Tez vertex scope-216	->	Tez vertex scope-215,
Tez vertex scope-215	->	Tez vertex scope-220,
Tez vertex scope-217	->	Tez vertex scope-219,
Tez vertex scope-218	->	Tez vertex scope-219,
Tez vertex scope-219	->	Tez vertex scope-220,
Tez vertex scope-220	->	Tez vertex scope-221,
Tez vertex scope-221	->	Tez vertex scope-223,
Tez vertex scope-222	->	Tez vertex scope-223,
Tez vertex scope-223	->	Tez vertex scope-224,
Tez vertex scope-224	->	Tez vertex scope-234,Tez vertex scope-245,
Tez vertex scope-234	->	Tez vertex scope-245,
Tez vertex scope-245	->	Tez vertex scope-247,
Tez vertex scope-247

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-214          1          1         400000                    0         400000             64          9732274       58864142                0 j4,partsupp		
scope-215          1          1           5025                    0           5000            633           125220         699860                0 j2,j3,supplier	REPLICATED_JOIN	
scope-216          1          1             25                    0             25              0              569           2199                0 nation		
scope-217          1          1         100000                    0           5842             64            87672       11944438                0 fpart,j1,part		
scope-218          4          4        2999671                    0        2999671            256        126896114      376276078                0 j1,lineitem		
scope-219          1          1              0              3005513          87306      126983818         35340190              0                0 j1,j3	HASH_JOIN	
scope-220          1          1              0                92306          43380        3761970          2270156              0                0 j3,j4	HASH_JOIN	
scope-221          1          1              0               443380          43380       11877786          2647588              0                0 j4,j5	HASH_JOIN	
scope-222          1          1         750000                    0         750000            544         21000382       85109145                0 j5,orders		
scope-223         11         11              0               793380          43380       23674556         19398451              0                0 grResult,j5,selo1,sumResult	HASH_JOIN	
scope-224          1          1              0                 1925            275          61874            10888              0                0 sortResult,sumResult	GROUP_BY,SAMPLER	
scope-234          1          1              0                  100              1           4882              106              0                0 		
scope-245          1          1            176                    0            175           6176             6006              0                0 sortResult		
scope-247          1          1              0                  175            175           6006                0              0             4964 	ORDER_BY	/tpch-pig/out/Q9out,

Input(s):
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"
Successfully read 400000 records (58864142 bytes) from: "/tpch-pig/in/partsupp"
Successfully read 100000 records (11944438 bytes) from: "/tpch-pig/in/part"
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"

Output(s):
Successfully stored 175 records (4964 bytes) in: "/tpch-pig/out/Q9out"

46639 [main] INFO  org.apache.pig.Main  - Pig script completed in 46 seconds and 809 milliseconds (46809 ms)
46639 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
46654 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@74616266
Q9 times (sec):	48

Clear buffer cache on HDFS cluster
Running Pig Query Q10
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q10.pig

62   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
63   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
960  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1076 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1550 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q10.pig-dad1bcf6-ba46-4ca4-9894-9e5edde31cdb
1551 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2682 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2724 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER,LIMIT
2765 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2805 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2852 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2928 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $1, $2, $3, $4, $7, $9, $10, $11, $12, $13, $14, $15
2931 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for nation: $2, $3
2932 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for customer: $6
2932 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $2, $3, $5, $6, $7, $8
3064 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-935830404 and resources directory is /tmp/temp-935830404
3094 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3150 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3175 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-217 and vertex - scope-226
3265 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3305 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3318 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3369 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3375 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3375 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3395 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3401 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3402 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3422 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3428 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3429 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3442 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-216 to 13
3792 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3792 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
4005 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-210: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4005 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: flineitem,l1,lineitem
4006 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[8,11],lineitem[-1,-1],flineitem[22,12],flineitem[-1,-1],l1[30,5]
4006 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4044 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-211: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4044 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: nation,o1
4044 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation[12,9],nation[-1,-1],o1[27,5]
4044 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4072 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-212: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4073 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: c1,customer
4073 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[4,11],customer[-1,-1],c1[24,5]
4073 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4104 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-213: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4104 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: c1,forders,orders
4104 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[6,9],orders[-1,-1],forders[21,10],forders[-1,-1],c1[24,5]
4104 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4146 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-214: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4146 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: c1,o1,selc1
4146 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: c1[24,5],selc1[25,8],o1[27,5]
4146 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4194 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-215: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4195 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l1,o1,selo1
4195 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: o1[27,5],selo1[28,8],l1[30,5]
4195 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4227 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-216: parallelism=13, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4228 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: grResult,l1,sell1,sumResult
4228 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: l1[30,5],sell1[31,8],sumResult[35,12],grResult[33,11]
4228 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4257 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-217: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4257 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult,sumResult
4257 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sumResult[35,12],sortResult[36,13]
4257 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4295 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-226: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4295 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4295 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4295 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4320 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-236: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4320 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult
4320 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sortResult[36,13]
4320 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4349 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-238: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4349 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4349 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4349 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4381 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 26
4417 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
9119 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q10.pig-0_scope-0
9692 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q10.pig-0_scope-0. Application id: application_1564404443351_0034
10410 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0034
10694 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 26 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30694 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 26 Succeeded: 15 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=null
35840 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 26 Succeeded: 26 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 73
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=26
		TOTAL_LAUNCHED_TASKS=27
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=7
		AM_CPU_MILLISECONDS=4200
		AM_GC_TIME_MILLIS=65
	File System Counters
		FILE_BYTES_READ=44991790
		FILE_BYTES_WRITTEN=61794128
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=473458364
		HDFS_BYTES_WRITTEN=3286
		HDFS_READ_OPS=16
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=447476
		REDUCE_INPUT_RECORDS=883970
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=1780436
		NUM_SHUFFLED_INPUTS=86
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=84
		GC_TIME_MILLIS=2330
		CPU_MILLISECONDS=79050
		PHYSICAL_MEMORY_BYTES=26520059904
		VIRTUAL_MEMORY_BYTES=196682260480
		COMMITTED_HEAP_BYTES=26520059904
		INPUT_RECORDS_PROCESSED=3835464
		INPUT_SPLIT_LENGTH_BYTES=473458364
		OUTPUT_RECORDS=922228
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=50021722
		OUTPUT_BYTES_WITH_OVERHEAD=44617855
		OUTPUT_BYTES_PHYSICAL=44618247
		ADDITIONAL_SPILLS_BYTES_WRITTEN=16520150
		ADDITIONAL_SPILLS_BYTES_READ=42966496
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=24
		SHUFFLE_BYTES=44618199
		SHUFFLE_BYTES_DECOMPRESSED=44617855
		SHUFFLE_BYTES_TO_MEM=16866400
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=27751799
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=3432
		MERGE_PHASE_TIME=4266
		FIRST_EVENT_RECEIVED=559
		LAST_EVENT_RECEIVED=2515
	MultiStoreCounters
		Output records in _0_Q10out=20
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=28825
		COMBINE_OUTPUT_RECORDS=12115
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false')
		approx_invocations=100
		approx_microsecs=308000
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=29300
		approx_microsecs=510400
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=10800
		approx_microsecs=104500
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=12800
		approx_microsecs=811800
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=2223700
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=14200
36424 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q10.pig                                                                                     
           StartedAt: 2019-08-05 18:05:18                                                                                 
          FinishedAt: 2019-08-05 18:05:52                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER,LIMIT                                                            

Success!


DAG 0:
                                    Name: PigLatin:Q10.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0034                                                                              
                      TotalLaunchedTasks: 27                                                                                                  
                           FileBytesRead: 44991790                                                                                            
                        FileBytesWritten: 61794128                                                                                            
                           HdfsBytesRead: 473458364                                                                                           
                        HdfsBytesWritten: 3286                                                                                                
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-210	->	Tez vertex scope-216,
Tez vertex scope-211	->	Tez vertex scope-215,
Tez vertex scope-212	->	Tez vertex scope-214,
Tez vertex scope-213	->	Tez vertex scope-214,
Tez vertex scope-214	->	Tez vertex scope-215,
Tez vertex scope-215	->	Tez vertex scope-216,
Tez vertex scope-216	->	Tez vertex scope-217,
Tez vertex scope-217	->	Tez vertex scope-226,Tez vertex scope-236,
Tez vertex scope-226	->	Tez vertex scope-236,
Tez vertex scope-236	->	Tez vertex scope-238,
Tez vertex scope-238

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-210          4          4        2999671                    0         739563           2560         20251556      376276078                0 flineitem,l1,lineitem		
scope-211          1          1             25                    0             25             64              569           2199                0 nation,o1		
scope-212          1          1          75000                    0          75000             64         12701930       12070942                0 c1,customer		
scope-213          1          1         750000                    0          28529             64           533023       85109145                0 c1,forders,orders		
scope-214          1          1              0               103529          14309       13234985          2903571              0                0 c1,o1,selc1	HASH_JOIN	
scope-215          1          1              0                14334          14309        2371789          2601558              0                0 l1,o1,selo1	HASH_JOIN	
scope-216         13         13              0               753872          28838       22913564         16265116              0                0 grResult,l1,sell1,sumResult	HASH_JOIN	
scope-217          1          1              0                12115          10867        2547572          2615643              0                0 sortResult,sumResult	GROUP_BY,SAMPLER	
scope-226          1          1              0                  100              1           3112             3210              0                0 		
scope-236          1          1          10768                    0          10767        1959056          1958992              0                0 sortResult		
scope-238          1          1              0                   20             20        1958960          1958960              0             3286 	ORDER_BY	/tpch-pig/out/Q10out,

Input(s):
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 75000 records (12070942 bytes) from: "/tpch-pig/in/customer"

Output(s):
Successfully stored 20 records (3286 bytes) in: "/tpch-pig/out/Q10out"

36449 [main] INFO  org.apache.pig.Main  - Pig script completed in 36 seconds and 601 milliseconds (36601 ms)
36450 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
36465 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@6b64e148
Q10 times (sec):	38

Clear buffer cache on HDFS cluster
Running Pig Query Q11
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q11.pig

62   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
62   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
942  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1054 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1533 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q11.pig-addc4702-c3ed-497d-acfa-cc37b4496dd7
1533 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2457 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2501 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2534 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2566 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2598 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for partsupp: $4
2601 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $1, $2, $4, $5, $6
2601 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for nation: $2, $3
2655 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2765 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-511147597 and resources directory is /tmp/temp-511147597
2797 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2861 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2876 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-119 and vertex - scope-128
2968 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3010 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3026 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3083 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3092 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3092 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3115 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3122 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3123 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3533 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3533 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3534 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3534 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3745 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-108: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3745 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j2,partsupp
3746 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: partsupp[3,11],partsupp[-1,-1],j2[15,5]
3746 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-109: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fnation,j1,nation
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation[7,9],nation[-1,-1],fnation[9,10],fnation[-1,-1],j1[11,5]
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3823 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-110: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3823 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j1,supplier
3823 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[5,11],supplier[-1,-1],j1[11,5]
3823 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3863 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-111: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3863 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j1,j2,selj1
3863 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: j1[11,5],selj1[13,8],j2[15,5]
3863 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
3920 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-112: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3921 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: grResult,j2,outerGrResult,outerSumResult,selj2,sumResult
3921 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: j2[15,5],selj2[17,8],sumResult[21,12],grResult[19,11],outerSumResult[27,17],outerGrResult[25,16]
3921 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN,MULTI_QUERY
3945 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-116: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3945 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sumResult
3945 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sumResult[21,12]
3946 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
3986 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-119: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3986 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: ord,outerHaving,outerSumResult
3986 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: outerSumResult[27,17],outerHaving[29,14],ord[31,6]
3986 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4022 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-128: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4022 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4022 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4022 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4045 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-138: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4045 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: ord
4045 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: ord[31,6]
4045 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4073 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-140: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4074 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4074 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4074 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4106 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 10
4143 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8814 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q11.pig-0_scope-0
9300 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q11.pig-0_scope-0. Application id: application_1564404443351_0035
10136 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0035
10302 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 10 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
22443 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 10 Succeeded: 10 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=Counters: 73
	org.apache.tez.common.counters.DAGCounter
		NUM_SUCCEEDED_TASKS=10
		TOTAL_LAUNCHED_TASKS=10
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=3
		AM_CPU_MILLISECONDS=2920
		AM_GC_TIME_MILLIS=85
	File System Counters
		FILE_BYTES_READ=8660680
		FILE_BYTES_WRITTEN=16957529
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=59566201
		HDFS_BYTES_WRITTEN=71673
		HDFS_READ_OPS=12
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		REDUCE_INPUT_GROUPS=22473
		REDUCE_INPUT_RECORDS=417448
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=834896
		NUM_SHUFFLED_INPUTS=11
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=8
		GC_TIME_MILLIS=707
		CPU_MILLISECONDS=27290
		PHYSICAL_MEMORY_BYTES=8365539328
		VIRTUAL_MEMORY_BYTES=74529255424
		COMMITTED_HEAP_BYTES=8365539328
		INPUT_RECORDS_PROCESSED=408885
		INPUT_SPLIT_LENGTH_BYTES=59566201
		OUTPUT_RECORDS=433849
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=12287722
		OUTPUT_BYTES_WITH_OVERHEAD=8659836
		OUTPUT_BYTES_PHYSICAL=8659952
		ADDITIONAL_SPILLS_BYTES_WRITTEN=8297297
		ADDITIONAL_SPILLS_BYTES_READ=8585127
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=8
		SHUFFLE_BYTES=8659880
		SHUFFLE_BYTES_DECOMPRESSED=8659836
		SHUFFLE_BYTES_TO_MEM=8297297
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=362583
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=369
		MERGE_PHASE_TIME=605
		FIRST_EVENT_RECEIVED=151
		LAST_EVENT_RECEIVED=151
	MultiStoreCounters
		Output records in _0_Q11out=3858
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=16958
		COMBINE_OUTPUT_RECORDS=8277
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false')
		approx_invocations=100
		approx_microsecs=268600
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.ReadScalarsTez('scope-116')
		approx_invocations=8300
		approx_microsecs=14700
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=17000
		approx_microsecs=212400
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=8400
		approx_microsecs=54500
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=8400
		approx_microsecs=820000
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=367300
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=19600
23150 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q11.pig                                                                                     
           StartedAt: 2019-08-05 18:05:58                                                                                 
          FinishedAt: 2019-08-05 18:06:19                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q11.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0035                                                                              
                      TotalLaunchedTasks: 10                                                                                                  
                           FileBytesRead: 8660680                                                                                             
                        FileBytesWritten: 16957529                                                                                            
                           HdfsBytesRead: 59566201                                                                                            
                        HdfsBytesWritten: 71673                                                                                               
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-108	->	Tez vertex scope-112,
Tez vertex scope-109	->	Tez vertex scope-111,
Tez vertex scope-110	->	Tez vertex scope-111,
Tez vertex scope-111	->	Tez vertex scope-112,
Tez vertex scope-112	->	Tez vertex scope-116,Tez vertex scope-119,
Tez vertex scope-116	->	Tez vertex scope-119,
Tez vertex scope-119	->	Tez vertex scope-128,Tez vertex scope-138,
Tez vertex scope-128	->	Tez vertex scope-138,
Tez vertex scope-138	->	Tez vertex scope-140,
Tez vertex scope-140

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-108          1          1         400000                    0         400000             64          8262222       58864142                0 j2,partsupp		
scope-109          1          1             25                    0              1             64               53           2199                0 fnation,j1,nation		
scope-110          1          1           5000                    0           5000             64            35139         699860                0 j1,supplier		
scope-111          1          1              0                 5001            212          35224            38329              0                0 j1,j2,selj1	HASH_JOIN	
scope-112          1          1              0               400212          16960        8265540          8469195              0                0 grResult,j2,outerGrResult,outerSumResult,selj2,sumResult	HASH_JOIN,MULTI_QUERY	
scope-116          1          1              0                    1              1             63               54              0                0 sumResult	GROUP_BY	
scope-119          1          1              1                 8276           3958         207060            77742              0                0 ord,outerHaving,outerSumResult	GROUP_BY,SAMPLER	
scope-128          1          1              0                  100              1           3045               98              0                0 		
scope-138          1          1           3859                    0           3858          74859            74697              0                0 ord		
scope-140          1          1              0                 3858           3858          74697                0              0            71673 	ORDER_BY	/tpch-pig/out/Q11out,

Input(s):
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"
Successfully read 400000 records (58864142 bytes) from: "/tpch-pig/in/partsupp"
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"

Output(s):
Successfully stored 3858 records (71673 bytes) in: "/tpch-pig/out/Q11out"

23174 [main] INFO  org.apache.pig.Main  - Pig script completed in 23 seconds and 338 milliseconds (23338 ms)
23202 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
23218 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@1367ff71
Q11 times (sec):	25

Clear buffer cache on HDFS cluster
Running Pig Query Q12
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q12.pig

71   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
71   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
933  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1035 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1533 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q12.pig-13bd2f72-1e9d-401a-a510-c16a35abce63
1533 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2432 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2473 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2512 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2550 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $1, $2, $3, $4, $6, $7, $8
2554 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $1, $2, $3, $4, $5, $6, $7, $8, $9, $13, $15
2617 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2734 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp1509379753 and resources directory is /tmp/temp1509379753
2765 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2829 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-105 and vertex - scope-114
2915 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
2958 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
2972 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3028 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3035 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3036 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3431 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3432 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3432 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3432 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3707 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-102: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3707 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: flineitem,l1,lineitem
3708 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[6,11],lineitem[-1,-1],flineitem[8,12],flineitem[-1,-1],l1[12,5]
3708 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3751 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-103: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3751 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l1,orders
3751 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[4,9],orders[-1,-1],l1[12,5]
3751 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-104: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: grpResult,l1,sell1
3794 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: l1[12,5],sell1[13,8],grpResult[15,12]
3794 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
3857 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-105: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3857 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult,sumResult,urgItems
3857 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sumResult[16,12],urgItems[17,15],urgItems[17,15],sortResult[20,13]
3857 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
3885 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-114: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3885 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
3885 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
3885 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3910 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-124: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3910 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sortResult
3910 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sortResult[20,13]
3910 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3941 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-126: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3941 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
3941 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
3941 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
3977 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 10
4015 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8181 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q12.pig-0_scope-0
8631 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q12.pig-0_scope-0. Application id: application_1564404443351_0036
9009 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0036
9633 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 10 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
29633 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 10 Succeeded: 5 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
30758 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 10 Succeeded: 10 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=Counters: 67
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=1
		NUM_SUCCEEDED_TASKS=10
		TOTAL_LAUNCHED_TASKS=10
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=5
		AM_CPU_MILLISECONDS=2760
		AM_GC_TIME_MILLIS=57
	File System Counters
		FILE_BYTES_READ=20383906
		FILE_BYTES_WRITTEN=20554308
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=461385223
		HDFS_BYTES_WRITTEN=30
		HDFS_READ_OPS=11
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=1
		REDUCE_INPUT_GROUPS=764615
		REDUCE_INPUT_RECORDS=781146
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=1562292
		NUM_SHUFFLED_INPUTS=10
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=8
		GC_TIME_MILLIS=1537
		CPU_MILLISECONDS=48360
		PHYSICAL_MEMORY_BYTES=9921101824
		VIRTUAL_MEMORY_BYTES=67826253824
		COMMITTED_HEAP_BYTES=9921101824
		INPUT_RECORDS_PROCESSED=3749674
		INPUT_SPLIT_LENGTH_BYTES=461385223
		OUTPUT_RECORDS=781151
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=18945298
		OUTPUT_BYTES_WITH_OVERHEAD=20383108
		OUTPUT_BYTES_PHYSICAL=20383196
		ADDITIONAL_SPILLS_BYTES_WRITTEN=170840
		ADDITIONAL_SPILLS_BYTES_READ=20383028
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=8
		SHUFFLE_BYTES=20383148
		SHUFFLE_BYTES_DECOMPRESSED=20383108
		SHUFFLE_BYTES_TO_MEM=170850
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=20212298
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=337
		MERGE_PHASE_TIME=370
		FIRST_EVENT_RECEIVED=154
		LAST_EVENT_RECEIVED=171
	MultiStoreCounters
		Output records in _0_Q12out=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('true')
		approx_invocations=100
		approx_microsecs=188100
	org.apache.pig.builtin.COUNT
		approx_invocations=300
		approx_microsecs=709700
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1946900
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=19800
31023 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q12.pig                                                                                     
           StartedAt: 2019-08-05 18:06:26                                                                                 
          FinishedAt: 2019-08-05 18:06:54                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q12.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0036                                                                              
                      TotalLaunchedTasks: 10                                                                                                  
                           FileBytesRead: 20383906                                                                                            
                        FileBytesWritten: 20554308                                                                                            
                           HdfsBytesRead: 461385223                                                                                           
                        HdfsBytesWritten: 30                                                                                                  
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-102	->	Tez vertex scope-104,
Tez vertex scope-103	->	Tez vertex scope-104,
Tez vertex scope-104	->	Tez vertex scope-105,
Tez vertex scope-105	->	Tez vertex scope-114,Tez vertex scope-124,
Tez vertex scope-114	->	Tez vertex scope-124,
Tez vertex scope-124	->	Tez vertex scope-126,
Tez vertex scope-126

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-102          4          4        2999671                    0          15571            256           342730      376276078                0 flineitem,l1,lineitem		
scope-103          1          1         750000                    0         750000             64         19800585       85109145                0 l1,orders		
scope-104          1          1              0               765571          15571       20143305           410644              0                0 grpResult,l1,sell1	HASH_JOIN	
scope-105          1          1              0                15571              4         239868              175              0                0 sortResult,sumResult,urgItems	GROUP_BY,SAMPLER	
scope-114          1          1              0                    2              1             97               96              0                0 		
scope-124          1          1              3                    0              2            238               78              0                0 sortResult		
scope-126          1          1              0                    2              2             78                0              0               30 	ORDER_BY	/tpch-pig/out/Q12out,

Input(s):
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"

Output(s):
Successfully stored 2 records (30 bytes) in: "/tpch-pig/out/Q12out"

31048 [main] INFO  org.apache.pig.Main  - Pig script completed in 31 seconds and 201 milliseconds (31201 ms)
31048 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
31064 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@5db5334c
Q12 times (sec):	32

Clear buffer cache on HDFS cluster
Running Pig Query Q13
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q13.pig

62   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
63   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
977  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1085 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1575 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q13.pig-14659afe-c7c2-412c-bf44-979204e31d84
1576 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2360 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_LONG 1 time(s).
2393 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: COGROUP,GROUP_BY,ORDER_BY,FILTER
2435 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2469 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2508 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2565 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for customer: $1, $2, $3, $4, $5, $6, $7
2567 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $2, $3, $4, $5, $6, $7
2706 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp1915105034 and resources directory is /tmp/temp1915105034
2737 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2788 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2811 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-63 and vertex - scope-73
2899 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
2946 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
2962 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3017 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3023 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3024 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3044 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-62 to 2
3439 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3439 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3440 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3442 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3674 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-60: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3674 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG1,customer,pcustomer
3674 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[3,11],pcustomer[-1,-1],COG1[13,7]
3674 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3726 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-61: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3727 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG1,forders,orders,porders
3727 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[5,9],orders[-1,-1],forders[7,10],porders[9,10],COG1[13,7]
3727 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3772 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-62: parallelism=2, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3772 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG,COG2,countResult,groupResult
3772 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: COG2[14,7],COG[15,6],countResult[19,14],groupResult[17,14]
3772 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: COGROUP
3823 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-63: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3823 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: countResult,orderResult
3823 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: countResult[19,14],orderResult[21,14]
3823 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
3864 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-73: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3864 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
3864 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
3864 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3887 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-84: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3888 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: orderResult
3888 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orderResult[21,14]
3888 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3922 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-86: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3922 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
3922 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
3922 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
3957 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 8
3995 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8155 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q13.pig-0_scope-0
8654 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q13.pig-0_scope-0. Application id: application_1564404443351_0037
8988 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0037
9656 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 8 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
27790 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 8 Succeeded: 8 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=Counters: 73
	org.apache.tez.common.counters.DAGCounter
		NUM_SUCCEEDED_TASKS=8
		TOTAL_LAUNCHED_TASKS=8
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=2
		AM_CPU_MILLISECONDS=2940
		AM_GC_TIME_MILLIS=61
	File System Counters
		FILE_BYTES_READ=9084822
		FILE_BYTES_WRITTEN=13625910
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=97180087
		HDFS_BYTES_WRITTEN=182
		HDFS_READ_OPS=11
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		REDUCE_INPUT_GROUPS=174749
		REDUCE_INPUT_RECORDS=817039
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=1634078
		NUM_SHUFFLED_INPUTS=10
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=8
		GC_TIME_MILLIS=1119
		CPU_MILLISECONDS=36190
		PHYSICAL_MEMORY_BYTES=6753878016
		VIRTUAL_MEMORY_BYTES=60914823168
		COMMITTED_HEAP_BYTES=6753878016
		INPUT_RECORDS_PROCESSED=825028
		INPUT_SPLIT_LENGTH_BYTES=97180087
		OUTPUT_RECORDS=892044
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=15439743
		OUTPUT_BYTES_WITH_OVERHEAD=9080593
		OUTPUT_BYTES_PHYSICAL=9080681
		ADDITIONAL_SPILLS_BYTES_WRITTEN=4544973
		ADDITIONAL_SPILLS_BYTES_READ=9080225
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=6
		SHUFFLE_BYTES=9080633
		SHUFFLE_BYTES_DECOMPRESSED=9080593
		SHUFFLE_BYTES_TO_MEM=4545033
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=4535600
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=1097
		MERGE_PHASE_TIME=1509
		FIRST_EVENT_RECEIVED=326
		LAST_EVENT_RECEIVED=718
	MultiStoreCounters
		Output records in _0_Q13out=27
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=74998
		COMBINE_OUTPUT_RECORDS=50
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false','false')
		approx_invocations=100
		approx_microsecs=134300
	org.apache.pig.builtin.COUNT
		approx_invocations=200000
		approx_microsecs=1025500
	org.apache.pig.builtin.COUNT$Final
		approx_invocations=100
		approx_microsecs=16100
	org.apache.pig.builtin.COUNT$Initial
		approx_invocations=75000
		approx_microsecs=248700
	org.apache.pig.builtin.COUNT$Intermediate
		approx_invocations=200
		approx_microsecs=564200
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=573600
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=19800
28005 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q13.pig                                                                                     
           StartedAt: 2019-08-05 18:07:01                                                                                 
          FinishedAt: 2019-08-05 18:07:26                                                                                 
            Features: COGROUP,GROUP_BY,ORDER_BY,FILTER                                                                    

Success!


DAG 0:
                                    Name: PigLatin:Q13.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0037                                                                              
                      TotalLaunchedTasks: 8                                                                                                   
                           FileBytesRead: 9084822                                                                                             
                        FileBytesWritten: 13625910                                                                                            
                           HdfsBytesRead: 97180087                                                                                            
                        HdfsBytesWritten: 182                                                                                                 
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-60	->	Tez vertex scope-62,
Tez vertex scope-61	->	Tez vertex scope-62,
Tez vertex scope-62	->	Tez vertex scope-63,
Tez vertex scope-63	->	Tez vertex scope-73,Tez vertex scope-84,
Tez vertex scope-73	->	Tez vertex scope-84,
Tez vertex scope-84	->	Tez vertex scope-86,
Tez vertex scope-86

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-60           1          1          75000                    0          75000            112          1125076       12070942                0 COG1,customer,pcustomer		
scope-61           1          1         750000                    0         741935            112          7953353       85109145                0 COG1,forders,orders,porders		
scope-62           2          2              0               816935          75000        9082150          4544559              0                0 COG,COG2,countResult,groupResult	COGROUP	
scope-63           1          1              0                   50             54           1049             1495              0                0 countResult,orderResult	GROUP_BY,SAMPLER	
scope-73           1          1              0                   27              1            607              699              0                0 		
scope-84           1          1             28                    0             27            444              380              0                0 orderResult		
scope-86           1          1              0                   27             27            348              348              0              182 	ORDER_BY	/tpch-pig/out/Q13out,

Input(s):
Successfully read 75000 records (12070942 bytes) from: "/tpch-pig/in/customer"
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"

Output(s):
Successfully stored 27 records (182 bytes) in: "/tpch-pig/out/Q13out"

28040 [main] INFO  org.apache.pig.Main  - Pig script completed in 28 seconds and 186 milliseconds (28186 ms)
28040 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
28061 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@262ec25b
Q13 times (sec):	29

Clear buffer cache on HDFS cluster
Running Pig Query Q14
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q14.pig

59   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
60   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
973  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1082 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1580 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q14.pig-1508f6b0-5954-49e1-9243-c56703c4c944
1580 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2453 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 2 time(s).
2495 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,FILTER
2529 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2562 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2601 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2695 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $0, $2, $3, $4, $7, $8, $9, $11, $12, $13, $14, $15
2818 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp1907217317 and resources directory is /tmp/temp1907217317
2851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2899 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2909 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3012 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3061 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3075 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3132 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3139 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3140 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3554 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3554 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3555 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3555 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3803 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-124: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3804 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: filtered_lineitem,lineitem,lineitem2,lineitem_part
3804 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[3,11],lineitem[-1,-1],filtered_lineitem[7,20],lineitem2[8,12],lineitem_part[10,16]
3805 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3850 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-125: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: lineitem_part,part
3851 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: part[5,7],part[-1,-1],lineitem_part[10,16]
3852 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3903 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-126: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3903 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: f_lineitem_part,f_lineitem_part_group,lineitem_part,lineitem_part_grouped,sum_all,sum_filter
3904 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem_part[10,16],f_lineitem_part[14,18],sum_filter[16,13],f_lineitem_part_group[15,24],sum_all[12,10],lineitem_part_grouped[11,24]
3904 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN,MULTI_QUERY
3952 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-133: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3953 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sum_all
3953 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sum_all[12,10]
3953 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
3988 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-130: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3989 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: sum_filter
3989 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sum_filter[16,13]
3990 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
4018 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-135: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4018 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4019 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4019 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4044 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-137: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4045 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: promo_revenue
4045 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: promo_revenue[18,16]
4045 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4083 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 10
4122 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8296 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q14.pig-0_scope-0
8824 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q14.pig-0_scope-0. Application id: application_1564404443351_0038
9117 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0038
9827 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 10 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
25955 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 10 Succeeded: 10 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=Counters: 75
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=1
		NUM_SUCCEEDED_TASKS=10
		TOTAL_LAUNCHED_TASKS=10
		OTHER_LOCAL_TASKS=2
		DATA_LOCAL_TASKS=5
		AM_CPU_MILLISECONDS=2740
		AM_GC_TIME_MILLIS=64
	File System Counters
		FILE_BYTES_READ=15040345
		FILE_BYTES_WRITTEN=15496677
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=388220516
		HDFS_BYTES_WRITTEN=19
		HDFS_READ_OPS=11
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=1
		REDUCE_INPUT_GROUPS=134529
		REDUCE_INPUT_RECORDS=137911
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=275822
		NUM_SHUFFLED_INPUTS=11
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=7
		GC_TIME_MILLIS=1765
		CPU_MILLISECONDS=46140
		PHYSICAL_MEMORY_BYTES=10240393216
		VIRTUAL_MEMORY_BYTES=67879645184
		COMMITTED_HEAP_BYTES=10240393216
		INPUT_RECORDS_PROCESSED=3099675
		INPUT_SPLIT_LENGTH_BYTES=388220516
		OUTPUT_RECORDS=160233
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=15135032
		OUTPUT_BYTES_WITH_OVERHEAD=15043400
		OUTPUT_BYTES_PHYSICAL=15043540
		ADDITIONAL_SPILLS_BYTES_WRITTEN=452881
		ADDITIONAL_SPILLS_BYTES_READ=15039521
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=7
		SHUFFLE_BYTES=15043444
		SHUFFLE_BYTES_DECOMPRESSED=15043400
		SHUFFLE_BYTES_TO_MEM=456716
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=14586728
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=430
		MERGE_PHASE_TIME=542
		FIRST_EVENT_RECEIVED=194
		LAST_EVENT_RECEIVED=214
	MultiStoreCounters
		Output records in _0_Q14out=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=22317
		COMBINE_OUTPUT_RECORDS=2
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.ReadScalarsTez('scope-130')
		approx_invocations=100
		approx_microsecs=5800
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.ReadScalarsTez('scope-135')
		approx_invocations=100
		approx_microsecs=7700
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=22400
		approx_microsecs=103900
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=200
		approx_microsecs=13700
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=200
		approx_microsecs=1554400
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1812000
	org.apache.pig.builtin.SUBSTRING
		approx_invocations=19100
		approx_microsecs=221700
26130 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q14.pig                                                                                     
           StartedAt: 2019-08-05 18:07:33                                                                                 
          FinishedAt: 2019-08-05 18:07:56                                                                                 
            Features: HASH_JOIN,GROUP_BY,FILTER                                                                           

Success!


DAG 0:
                                    Name: PigLatin:Q14.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0038                                                                              
                      TotalLaunchedTasks: 10                                                                                                  
                           FileBytesRead: 15040345                                                                                            
                        FileBytesWritten: 15496677                                                                                            
                           HdfsBytesRead: 388220516                                                                                           
                        HdfsBytesWritten: 19                                                                                                  
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-124	->	Tez vertex scope-126,
Tez vertex scope-125	->	Tez vertex scope-126,
Tez vertex scope-126	->	Tez vertex scope-130,Tez vertex scope-133,
Tez vertex scope-133	->	Tez vertex scope-135,Tez vertex scope-137,
Tez vertex scope-130	->	Tez vertex scope-137,
Tez vertex scope-135	->	Tez vertex scope-137,
Tez vertex scope-137

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-124          4          4        2999671                    0          37909            256           909984      376276078                0 filtered_lineitem,lineitem,lineitem2,lineitem_part		
scope-125          1          1         100000                    0         100000             64         14133470       11944438                0 lineitem_part,part		
scope-126          1          1              0               137909          22319       15039683           453007              0                0 f_lineitem_part,f_lineitem_part_group,lineitem_part,lineitem_part_grouped,sum_all,sum_filter	HASH_JOIN,MULTI_QUERY	
scope-130          1          1              0                    1              1             63               54              0                0 sum_filter	GROUP_BY	
scope-133          1          1              0                    1              2             63              108              0                0 sum_all	GROUP_BY	
scope-135          1          1              1                    0              1             54               54              0                0 		
scope-137          1          1              3                    0              1            162                0              0               19 promo_revenue		/tpch-pig/out/Q14out,

Input(s):
Successfully read 100000 records (11944438 bytes) from: "/tpch-pig/in/part"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"

Output(s):
Successfully stored 1 records (19 bytes) in: "/tpch-pig/out/Q14out"

26160 [main] INFO  org.apache.pig.Main  - Pig script completed in 26 seconds and 305 milliseconds (26305 ms)
26170 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
26186 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@611b0031
Q14 times (sec):	27

Clear buffer cache on HDFS cluster
Running Pig Query Q15
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q15.pig

62   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
63   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
917  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1019 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1513 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q15.pig-7b0cd6ad-2622-47ed-a918-37e93ff36cf5
1513 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2637 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2677 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2709 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2741 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2780 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2849 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $3, $5, $6
2852 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $0, $1, $3, $4, $7, $8, $9, $11, $12, $13, $14, $15
2980 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp384134012 and resources directory is /tmp/temp384134012
3016 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3079 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3089 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3105 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-114 and vertex - scope-123
3195 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3238 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3253 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3306 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3313 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3314 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3735 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3735 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3736 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3736 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3955 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-111: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3955 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j1,supplier
3956 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[5,11],supplier[-1,-1],j1[21,5]
3956 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4015 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-105: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4016 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: flineitem,glineitem,lineitem,revenue,sumlineitem
4016 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[3,11],lineitem[-1,-1],flineitem[7,12],sumlineitem[9,14],revenue[13,10],glineitem[11,12]
4016 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4065 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-106: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4066 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: grevenue,max_revenue,revenue
4066 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: revenue[13,10],max_revenue[17,14],grevenue[15,11]
4066 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,MULTI_QUERY
4122 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-110: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4122 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: max_revenue
4123 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: max_revenue[17,14]
4123 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
4156 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-112: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4156 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j1,top_revenue
4156 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: top_revenue[19,14],j1[21,5]
4156 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4184 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-114: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4185 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: j1,ord,sel
4185 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: j1[21,5],sel[23,6],ord[25,6]
4185 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN,SAMPLER
4213 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-123: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4213 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4213 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4214 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4237 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-133: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4237 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: ord
4237 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: ord[25,6]
4237 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4268 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-135: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4269 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4269 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4269 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4304 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 12
4343 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
9013 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q15.pig-0_scope-0
9557 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q15.pig-0_scope-0. Application id: application_1564404443351_0039
10336 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0039
10559 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 12 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
25683 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 12 Succeeded: 12 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=Counters: 75
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=1
		NUM_SUCCEEDED_TASKS=12
		TOTAL_LAUNCHED_TASKS=13
		OTHER_LOCAL_TASKS=2
		DATA_LOCAL_TASKS=5
		AM_CPU_MILLISECONDS=3120
		AM_GC_TIME_MILLIS=56
	File System Counters
		FILE_BYTES_READ=1422397
		FILE_BYTES_WRITTEN=1894278
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=376975938
		HDFS_BYTES_WRITTEN=0
		HDFS_READ_OPS=11
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=1
		REDUCE_INPUT_GROUPS=15002
		REDUCE_INPUT_RECORDS=42678
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=85356
		NUM_SHUFFLED_INPUTS=9
		NUM_SKIPPED_INPUTS=2
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=7
		GC_TIME_MILLIS=1252
		CPU_MILLISECONDS=49840
		PHYSICAL_MEMORY_BYTES=10709630976
		VIRTUAL_MEMORY_BYTES=84767326208
		COMMITTED_HEAP_BYTES=10709630976
		INPUT_RECORDS_PROCESSED=3014672
		INPUT_SPLIT_LENGTH_BYTES=376975938
		OUTPUT_RECORDS=138330
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=3326461
		OUTPUT_BYTES_WITH_OVERHEAD=1501896
		OUTPUT_BYTES_PHYSICAL=1501980
		ADDITIONAL_SPILLS_BYTES_WRITTEN=391910
		ADDITIONAL_SPILLS_BYTES_READ=1271693
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=9
		SHUFFLE_BYTES=1501932
		SHUFFLE_BYTES_DECOMPRESSED=1501896
		SHUFFLE_BYTES_TO_MEM=472245
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=1029687
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=293
		MERGE_PHASE_TIME=320
		FIRST_EVENT_RECEIVED=94
		LAST_EVENT_RECEIVED=94
	MultiStoreCounters
		Output records in _0_Q15out=0
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=123323
		COMBINE_OUTPUT_RECORDS=37677
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.ReadScalarsTez('scope-110')
		approx_invocations=10000
		approx_microsecs=51800
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=123500
		approx_microsecs=428900
	org.apache.pig.builtin.DoubleMax$Final
		approx_invocations=100
		approx_microsecs=9500
	org.apache.pig.builtin.DoubleMax$Intermediate
		approx_invocations=100
		approx_microsecs=529800
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=10000
		approx_microsecs=370700
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=37800
		approx_microsecs=1388000
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1563700
26349 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q15.pig                                                                                     
           StartedAt: 2019-08-05 18:08:03                                                                                 
          FinishedAt: 2019-08-05 18:08:26                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q15.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0039                                                                              
                      TotalLaunchedTasks: 13                                                                                                  
                           FileBytesRead: 1422397                                                                                             
                        FileBytesWritten: 1894278                                                                                             
                           HdfsBytesRead: 376975938                                                                                           
                        HdfsBytesWritten: 0                                                                                                   
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-111	->	Tez vertex scope-114,
Tez vertex scope-105	->	Tez vertex scope-106,
Tez vertex scope-106	->	Tez vertex scope-110,Tez vertex scope-112,
Tez vertex scope-110	->	Tez vertex scope-112,
Tez vertex scope-112	->	Tez vertex scope-114,
Tez vertex scope-114	->	Tez vertex scope-123,Tez vertex scope-133,
Tez vertex scope-123	->	Tez vertex scope-133,
Tez vertex scope-133	->	Tez vertex scope-135,
Tez vertex scope-135

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-105          4          4        2999671                    0         113328            256           942068      376276078                0 flineitem,glineitem,lineitem,revenue,sumlineitem		
scope-106          1          1              0                37676          20000         861733           541887              0                0 grevenue,max_revenue,revenue	GROUP_BY,MULTI_QUERY	
scope-110          1          1              0                    1              1             63               54              0                0 max_revenue	GROUP_BY	
scope-111          1          1           5000                    0           5000             64           410055         699860                0 j1,supplier		
scope-112          1          1          10001                    0              1         150032               66              0                0 j1,top_revenue		
scope-114          1          1              0                 5001              0         410185               74              0                0 j1,ord,sel	HASH_JOIN,SAMPLER	
scope-123          1          1              0                    0              0              0               42              0                0 		
scope-133          1          1              0                    0              0             64               32              0                0 ord		
scope-135          1          1              0                    0              0              0                0              0                0 	ORDER_BY	/tpch-pig/out/Q15out,

Input(s):
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"

Output(s):
Successfully stored 0 records in: "/tpch-pig/out/Q15out"

26371 [main] INFO  org.apache.pig.Main  - Pig script completed in 26 seconds and 521 milliseconds (26521 ms)
26381 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
26396 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@6d3b0d99
Q15 times (sec):	28

Clear buffer cache on HDFS cluster
Running Pig Query Q16
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q16.pig

64   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
65   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
978  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1103 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1625 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q16.pig-d7db6d4e-b4a6-46cb-b0ed-0d3d72249c9d
1626 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2517 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_CHARARRAY 4 time(s).
2551 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2586 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2619 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2660 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for parts: $1, $2, $6, $7, $8
2662 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for partsupp: $2, $3, $4
2662 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $1, $2, $3, $4, $5
2712 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2835 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp1378907390 and resources directory is /tmp/temp1378907390
2866 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2919 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2946 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-103 and vertex - scope-115
3032 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3074 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3088 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3140 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3147 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3148 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3169 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3175 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3176 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3192 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-102 to 11
3582 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3582 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3582 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3582 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3827 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-98: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3828 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fparts,p1,parts,pparts
3828 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: parts[13,8],fparts[26,9],pparts[-1,-1],p1[33,5]
3828 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3870 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-99: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3870 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: partsupp,pss
3870 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: partsupp[15,11],partsupp[-1,-1],pss[22,6]
3870 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3901 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-100: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3902 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fs1,fsupplier,pss,supplier
3902 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[17,11],fsupplier[19,12],fs1[-1,-1],pss[22,6]
3902 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3943 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-101: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3944 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fpartsupp,p1,pss
3944 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: pss[22,6],fpartsupp[24,12],p1[33,5]
3944 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
3998 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-102: parallelism=11, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3998 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 1-3,countResult,grResult,p1
3998 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: p1[33,5],countResult[35,14],1-3[37,19],grResult[34,11]
3998 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4031 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-103: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4031 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: countResult,orderResult
4031 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: countResult[35,14],orderResult[40,14]
4032 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4048 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Turning off combiner in reducer vertex scope-103 for edge from scope-102
4074 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-115: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4074 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4074 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4075 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4097 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-128: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4097 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: orderResult
4097 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orderResult[40,14]
4097 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4125 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-130: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4125 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4125 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4125 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4159 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 19
4195 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8375 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q16.pig-0_scope-0
8864 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q16.pig-0_scope-0. Application id: application_1564404443351_0040
9188 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0040
9866 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 19 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
29003 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 19 Succeeded: 19 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=Counters: 75
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=1
		NUM_SUCCEEDED_TASKS=19
		TOTAL_LAUNCHED_TASKS=19
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=3
		AM_CPU_MILLISECONDS=3770
		AM_GC_TIME_MILLIS=120
	File System Counters
		FILE_BYTES_READ=10456741
		FILE_BYTES_WRITTEN=11490740
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=71508440
		HDFS_BYTES_WRITTEN=407241
		HDFS_READ_OPS=15
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=1
		REDUCE_INPUT_GROUPS=153004
		REDUCE_INPUT_RECORDS=645843
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=1290310
		NUM_SHUFFLED_INPUTS=39
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=37
		GC_TIME_MILLIS=897
		CPU_MILLISECONDS=45750
		PHYSICAL_MEMORY_BYTES=14712569856
		VIRTUAL_MEMORY_BYTES=150596603904
		COMMITTED_HEAP_BYTES=14712569856
		INPUT_RECORDS_PROCESSED=516528
		INPUT_SPLIT_LENGTH_BYTES=71508440
		OUTPUT_RECORDS=684094
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=14609841
		OUTPUT_BYTES_WITH_OVERHEAD=10510902
		OUTPUT_BYTES_PHYSICAL=10511106
		ADDITIONAL_SPILLS_BYTES_WRITTEN=978594
		ADDITIONAL_SPILLS_BYTES_READ=9892782
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=17
		SHUFFLE_BYTES=10511058
		SHUFFLE_BYTES_DECOMPRESSED=10510902
		SHUFFLE_BYTES_TO_MEM=1062859
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=9448199
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=3800
		MERGE_PHASE_TIME=4137
		FIRST_EVENT_RECEIVED=467
		LAST_EVENT_RECEIVED=3207
	MultiStoreCounters
		Output records in _0_Q16out=11527
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=29671
		COMBINE_OUTPUT_RECORDS=14486
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false','true','true','true')
		approx_invocations=100
		approx_microsecs=169700
	org.apache.pig.builtin.COUNT
		approx_invocations=11600
		approx_microsecs=44500
	org.apache.pig.builtin.Distinct$Final
		approx_invocations=11600
		approx_microsecs=188800
	org.apache.pig.builtin.Distinct$Initial
		approx_invocations=30100
		approx_microsecs=586800
	org.apache.pig.builtin.Distinct$Intermediate
		approx_invocations=14900
		approx_microsecs=980800
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=514000
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=25700
29202 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q16.pig                                                                                     
           StartedAt: 2019-08-05 18:08:33                                                                                 
          FinishedAt: 2019-08-05 18:09:00                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q16.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0040                                                                              
                      TotalLaunchedTasks: 19                                                                                                  
                           FileBytesRead: 10456741                                                                                            
                        FileBytesWritten: 11490740                                                                                            
                           HdfsBytesRead: 71508440                                                                                            
                        HdfsBytesWritten: 407241                                                                                              
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-98	->	Tez vertex scope-102,
Tez vertex scope-99	->	Tez vertex scope-101,
Tez vertex scope-100	->	Tez vertex scope-101,
Tez vertex scope-101	->	Tez vertex scope-102,
Tez vertex scope-102	->	Tez vertex scope-103,
Tez vertex scope-103	->	Tez vertex scope-115,Tez vertex scope-128,
Tez vertex scope-115	->	Tez vertex scope-128,
Tez vertex scope-128	->	Tez vertex scope-130,
Tez vertex scope-130

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-100          1          1           5000                    0           4997             64            68894         699860                0 fs1,fsupplier,pss,supplier		
scope-101          1          1              0               404997         199880        4543922          3312099              0                0 fpartsupp,p1,pss	HASH_JOIN	
scope-102         11         11              0               214733          29682        4031995          1253762              0                0 1-3,countResult,grResult,p1	HASH_JOIN	
scope-103          1          1              0                14486          11627         802968           543141              0                0 countResult,orderResult	GROUP_BY,SAMPLER	
scope-115          1          1              0                  100              1           9066             9192              0                0 		
scope-128          1          1          11528                    0          11527         534107           534043              0                0 orderResult		
scope-130          1          1              0                11527          11527         534011           534011              0           407241 	ORDER_BY	/tpch-pig/out/Q16out,
scope-98           1          1         100000                    0          14853            544           761082       11944438                0 fparts,p1,parts,pparts		
scope-99           1          1         400000                    0         400000             64          4474516       58864142                0 partsupp,pss		

Input(s):
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"
Successfully read 100000 records (11944438 bytes) from: "/tpch-pig/in/part"
Successfully read 400000 records (58864142 bytes) from: "/tpch-pig/in/partsupp"

Output(s):
Successfully stored 11527 records (407241 bytes) in: "/tpch-pig/out/Q16out"

29223 [main] INFO  org.apache.pig.Main  - Pig script completed in 29 seconds and 386 milliseconds (29386 ms)
29224 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
29238 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@56a7e6d4
Q16 times (sec):	31

Clear buffer cache on HDFS cluster
Running Pig Query Q17
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q17.pig

65   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
65   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
961  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1071 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1569 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q17.pig-65a48238-9dc8-4387-a851-48bafae56e9e
1570 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2440 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_LONG 1 time(s).
2441 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2474 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: COGROUP,GROUP_BY,FILTER
2515 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2553 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2596 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2669 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $0, $2, $3, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15
2672 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for part: $1, $2, $4, $5, $7, $8
2806 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp1770492645 and resources directory is /tmp/temp1770492645
2846 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2888 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3004 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3049 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3064 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3121 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3128 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3129 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3145 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-88 to 5
3565 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3565 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3565 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3565 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3799 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-86: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3799 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG1,part
3800 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: part[5,7],part[-1,-1],part[8,7],part[9,7],COG1[11,7]
3800 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3845 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-87: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3845 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG1,lineitem
3845 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[3,11],lineitem[-1,-1],COG1[11,7]
3846 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3899 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-88: parallelism=5, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3900 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG,COG1,COG2,COG3,G1,result
3900 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: COG1[-1,-1],COG1[12,7],COG2[13,7],COG3[15,7],COG[16,6],result[20,9],G1[18,5]
3900 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: COGROUP
3958 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-89: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3958 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: result
3958 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: result[20,9]
3959 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
4008 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 11
4046 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8206 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q17.pig-0_scope-0
8684 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q17.pig-0_scope-0. Application id: application_1564404443351_0041
9040 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0041
9687 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 11 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
29687 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 11 Succeeded: 10 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=null
30016 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 11 Succeeded: 11 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 72
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=11
		TOTAL_LAUNCHED_TASKS=11
		DATA_LOCAL_TASKS=5
		AM_CPU_MILLISECONDS=3080
		AM_GC_TIME_MILLIS=45
	File System Counters
		FILE_BYTES_READ=73623714
		FILE_BYTES_WRITTEN=111596982
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=388220516
		HDFS_BYTES_WRITTEN=18
		HDFS_READ_OPS=11
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=200106
		REDUCE_INPUT_RECORDS=2999781
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=5999562
		NUM_SHUFFLED_INPUTS=30
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=30
		GC_TIME_MILLIS=2308
		CPU_MILLISECONDS=69490
		PHYSICAL_MEMORY_BYTES=10896277504
		VIRTUAL_MEMORY_BYTES=76247416832
		COMMITTED_HEAP_BYTES=10896277504
		INPUT_RECORDS_PROCESSED=3099671
		INPUT_SPLIT_LENGTH_BYTES=388220516
		OUTPUT_RECORDS=2999937
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=92994206
		OUTPUT_BYTES_WITH_OVERHEAD=76007647
		OUTPUT_BYTES_PHYSICAL=76007767
		ADDITIONAL_SPILLS_BYTES_WRITTEN=35588415
		ADDITIONAL_SPILLS_BYTES_READ=73599175
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=10
		SHUFFLE_BYTES=76007767
		SHUFFLE_BYTES_DECOMPRESSED=76007647
		SHUFFLE_BYTES_TO_MEM=37997007
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=38010760
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=2307
		MERGE_PHASE_TIME=3578
		FIRST_EVENT_RECEIVED=509
		LAST_EVENT_RECEIVED=1615
	MultiStoreCounters
		Output records in _0_Q17out=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=155
		COMBINE_OUTPUT_RECORDS=5
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=500
		approx_microsecs=27500
	org.apache.pig.builtin.COUNT
		approx_invocations=200500
		approx_microsecs=1963300
	org.apache.pig.builtin.DoubleAvg
		approx_invocations=500
		approx_microsecs=266400
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=100
		approx_microsecs=245800
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=500
		approx_microsecs=607600
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1650900
31055 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q17.pig                                                                                     
           StartedAt: 2019-08-05 18:09:07                                                                                 
          FinishedAt: 2019-08-05 18:09:35                                                                                 
            Features: COGROUP,GROUP_BY,FILTER                                                                             

Success!


DAG 0:
                                    Name: PigLatin:Q17.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0041                                                                              
                      TotalLaunchedTasks: 11                                                                                                  
                           FileBytesRead: 73623714                                                                                            
                        FileBytesWritten: 111596982                                                                                           
                           HdfsBytesRead: 388220516                                                                                           
                        HdfsBytesWritten: 18                                                                                                  
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-86	->	Tez vertex scope-88,
Tez vertex scope-87	->	Tez vertex scope-88,
Tez vertex scope-88	->	Tez vertex scope-89,
Tez vertex scope-89

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-86           1          1         100000                    0            105            256             1753       11944438                0 COG1,part		
scope-87           4          4        2999671                    0        2999671           1024         76006499      376276078                0 COG1,lineitem		
scope-88           5          5              0              2999776            160       73622151         35588699              0                0 COG,COG1,COG2,COG3,G1,result	COGROUP	
scope-89           1          1              0                    5              1            283               31              0               18 result	GROUP_BY	/tpch-pig/out/Q17out,

Input(s):
Successfully read 100000 records (11944438 bytes) from: "/tpch-pig/in/part"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"

Output(s):
Successfully stored 1 records (18 bytes) in: "/tpch-pig/out/Q17out"

31079 [main] INFO  org.apache.pig.Main  - Pig script completed in 31 seconds and 236 milliseconds (31236 ms)
31079 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
31092 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@14ee6280
Q17 times (sec):	33

Clear buffer cache on HDFS cluster
Running Pig Query Q18
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q18.pig

60   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
61   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
925  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1047 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1556 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q18.pig-73fdc1a3-a9fa-4daf-b232-be657e118c16
1557 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2461 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2500 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,COGROUP,GROUP_BY,ORDER_BY,FILTER
2536 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2572 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2615 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2693 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $1, $2, $3, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15
2696 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $2, $5, $6, $7, $8
2828 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-1263431118 and resources directory is /tmp/temp-1263431118
2861 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2915 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2940 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-122 and vertex - scope-132
3028 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3072 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3087 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3144 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3151 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3152 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3177 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3183 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3184 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3200 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-121 to 8
3578 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3578 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3578 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3578 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-117: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: customer,lineitem_orders_customer
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[5,11],customer[-1,-1],lineitem_orders_customer[17,27]
3793 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3840 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-118: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3841 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG,lineitem
3841 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[3,11],lineitem[-1,-1],COG[11,6]
3841 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3876 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-119: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3876 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG,orders
3876 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[7,9],orders[-1,-1],COG[11,6]
3876 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3931 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-120: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3931 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: COG,lineitem_orders,lineitem_orders_customer
3932 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: COG[-1,-1],COG[13,6],lineitem_orders[15,18],lineitem_orders_customer[17,27]
3932 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: COGROUP
3993 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-121: parallelism=8, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3993 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: lineitem_orders_customer,lineitem_orders_customer_group,result
3993 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem_orders_customer[17,27],result[20,9],lineitem_orders_customer_group[19,33]
3994 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4023 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-122: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4023 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: out,result
4024 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: result[20,9],out[22,6]
4024 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4063 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-132: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4064 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4064 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4064 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4087 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-143: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4087 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: out
4087 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: out[22,6]
4087 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4116 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-145: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4116 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4116 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4116 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4150 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 19
4187 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8834 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q18.pig-0_scope-0
9377 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q18.pig-0_scope-0. Application id: application_1564404443351_0042
10181 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0042
10379 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 19 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30379 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 19 Succeeded: 6 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
39517 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 19 Succeeded: 19 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 75
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=19
		TOTAL_LAUNCHED_TASKS=19
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=6
		AM_CPU_MILLISECONDS=3720
		AM_GC_TIME_MILLIS=61
	File System Counters
		FILE_BYTES_READ=93324884
		FILE_BYTES_WRITTEN=162368184
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=473456165
		HDFS_BYTES_WRITTEN=415
		HDFS_READ_OPS=15
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=1575050
		REDUCE_INPUT_RECORDS=3824721
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=7649442
		NUM_SHUFFLED_INPUTS=29
		NUM_SKIPPED_INPUTS=4
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=27
		GC_TIME_MILLIS=1907
		CPU_MILLISECONDS=69580
		PHYSICAL_MEMORY_BYTES=27002929152
		VIRTUAL_MEMORY_BYTES=140547842048
		COMMITTED_HEAP_BYTES=27002929152
		INPUT_RECORDS_PROCESSED=3824679
		INPUT_SPLIT_LENGTH_BYTES=473456165
		OUTPUT_RECORDS=3824743
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=109056673
		OUTPUT_BYTES_WITH_OVERHEAD=93315342
		OUTPUT_BYTES_PHYSICAL=93315518
		ADDITIONAL_SPILLS_BYTES_WRITTEN=69051770
		ADDITIONAL_SPILLS_BYTES_READ=93314855
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=17
		SHUFFLE_BYTES=93315440
		SHUFFLE_BYTES_DECOMPRESSED=93315324
		SHUFFLE_BYTES_TO_MEM=69051780
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=24263660
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=1222
		MERGE_PHASE_TIME=3380
		FIRST_EVENT_RECEIVED=291
		LAST_EVENT_RECEIVED=295
	MultiStoreCounters
		Output records in _0_Q18out=7
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=7
		COMBINE_OUTPUT_RECORDS=7
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false','true')
		approx_invocations=100
		approx_microsecs=105600
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=700
		approx_microsecs=78500
	org.apache.pig.builtin.DoubleSum
		approx_invocations=750100
		approx_microsecs=1868500
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=100
		approx_microsecs=15000
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=400
		approx_microsecs=47000
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=2142200
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=11400
40197 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q18.pig                                                                                     
           StartedAt: 2019-08-05 18:09:42                                                                                 
          FinishedAt: 2019-08-05 18:10:19                                                                                 
            Features: HASH_JOIN,COGROUP,GROUP_BY,ORDER_BY,FILTER                                                          

Success!


DAG 0:
                                    Name: PigLatin:Q18.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0042                                                                              
                      TotalLaunchedTasks: 19                                                                                                  
                           FileBytesRead: 93324884                                                                                            
                        FileBytesWritten: 162368184                                                                                           
                           HdfsBytesRead: 473456165                                                                                           
                        HdfsBytesWritten: 415                                                                                                 
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-117	->	Tez vertex scope-121,
Tez vertex scope-118	->	Tez vertex scope-120,
Tez vertex scope-119	->	Tez vertex scope-120,
Tez vertex scope-120	->	Tez vertex scope-121,
Tez vertex scope-121	->	Tez vertex scope-122,
Tez vertex scope-122	->	Tez vertex scope-132,Tez vertex scope-143,
Tez vertex scope-132	->	Tez vertex scope-143,
Tez vertex scope-143	->	Tez vertex scope-145,
Tez vertex scope-145

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-117          1          1          75000                    0          75000            400         13609897       12070942                0 customer,lineitem_orders_customer		
scope-118          4          4        2999671                    0        2999671            256         48531511      376276078                0 COG,lineitem		
scope-119          1          1         750000                    0         750000             64         31170816       85109145                0 COG,orders		
scope-120          1          1              0              3749671             29       79702621         55443828              0                0 COG,lineitem_orders,lineitem_orders_customer	COGROUP	
scope-121          8          8              0                75029             14       13619138         13610516              0                0 lineitem_orders_customer,lineitem_orders_customer_group,result	HASH_JOIN	
scope-122          1          1              0                    7             14            725              977              0                0 out,result	GROUP_BY,SAMPLER	
scope-132          1          1              0                    7              1            449              111              0                0 		
scope-143          1          1              8                    0              7            703              528              0                0 out		
scope-145          1          1              0                    7              7            528                0              0              415 	ORDER_BY	/tpch-pig/out/Q18out,

Input(s):
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 75000 records (12070942 bytes) from: "/tpch-pig/in/customer"
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"

Output(s):
Successfully stored 7 records (415 bytes) in: "/tpch-pig/out/Q18out"

40220 [main] INFO  org.apache.pig.Main  - Pig script completed in 40 seconds and 375 milliseconds (40375 ms)
40220 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
40240 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@5f6cf3b5
Q18 times (sec):	42

Clear buffer cache on HDFS cluster
Running Pig Query Q19
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q19.pig

64   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
65   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
947  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1059 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1577 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q19.pig-e42e39b5-96e1-4968-b6ad-69463ffa46b1
1577 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2453 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_LONG 6 time(s).
2453 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 7 time(s).
2490 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,FILTER
2524 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2557 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2595 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
3027 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $0, $2, $3, $7, $8, $9, $10, $11, $12, $15
3030 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for part: $1, $2, $4, $7, $8
3176 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp1943701786 and resources directory is /tmp/temp1943701786
3202 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3238 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3340 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3381 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3394 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3447 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3454 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3455 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3466 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-203 to 5
3801 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3801 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3801 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3802 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
4019 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-201: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4020 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: lineitem,lpart
4020 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[4,11],lineitem[-1,-1],lpart[8,8]
4020 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4065 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-202: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4065 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: lpart,part
4065 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: part[6,7],part[-1,-1],lpart[8,8]
4066 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4142 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-203: parallelism=5, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4142 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fltResult,grpResult,lpart,revenue,volume
4143 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lpart[8,8],lpart[-1,-1],fltResult[10,12],volume[37,9],revenue[39,10],grpResult[38,12]
4143 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4198 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-204: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4199 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: revenue
4199 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: revenue[39,10]
4199 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
4249 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 11
4290 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
9536 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q19.pig-0_scope-0
10016 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q19.pig-0_scope-0. Application id: application_1564404443351_0043
10280 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0043
11018 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 11 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
31019 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 11 Succeeded: 5 Running: 3 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
37176 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 11 Succeeded: 11 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 68
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=11
		TOTAL_LAUNCHED_TASKS=13
		DATA_LOCAL_TASKS=5
		AM_CPU_MILLISECONDS=3800
		AM_GC_TIME_MILLIS=50
	File System Counters
		FILE_BYTES_READ=171320954
		FILE_BYTES_WRITTEN=257025013
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=388220516
		HDFS_BYTES_WRITTEN=11
		HDFS_READ_OPS=11
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=300001
		REDUCE_INPUT_RECORDS=3099676
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=6199352
		NUM_SHUFFLED_INPUTS=30
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=30
		GC_TIME_MILLIS=2084
		CPU_MILLISECONDS=85270
		PHYSICAL_MEMORY_BYTES=13568573440
		VIRTUAL_MEMORY_BYTES=76254855168
		COMMITTED_HEAP_BYTES=13568573440
		INPUT_RECORDS_PROCESSED=3099671
		INPUT_SPLIT_LENGTH_BYTES=388220516
		OUTPUT_RECORDS=3099697
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=190484207
		OUTPUT_BYTES_WITH_OVERHEAD=173700003
		OUTPUT_BYTES_PHYSICAL=173700123
		ADDITIONAL_SPILLS_BYTES_WRITTEN=83324090
		ADDITIONAL_SPILLS_BYTES_READ=171289634
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=10
		SHUFFLE_BYTES=173700123
		SHUFFLE_BYTES_DECOMPRESSED=173700003
		SHUFFLE_BYTES_TO_MEM=85734579
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=87965544
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=3988
		MERGE_PHASE_TIME=5457
		FIRST_EVENT_RECEIVED=431
		LAST_EVENT_RECEIVED=2930
	MultiStoreCounters
		Output records in _0_Q19out=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=20
		COMBINE_OUTPUT_RECORDS=5
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=500
		approx_microsecs=206200
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=100
		approx_microsecs=10300
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=500
		approx_microsecs=688500
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1624200
37294 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q19.pig                                                                                     
           StartedAt: 2019-08-05 18:10:26                                                                                 
          FinishedAt: 2019-08-05 18:11:00                                                                                 
            Features: HASH_JOIN,GROUP_BY,FILTER                                                                           

Success!


DAG 0:
                                    Name: PigLatin:Q19.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0043                                                                              
                      TotalLaunchedTasks: 13                                                                                                  
                           FileBytesRead: 171320954                                                                                           
                        FileBytesWritten: 257025013                                                                                           
                           HdfsBytesRead: 388220516                                                                                           
                        HdfsBytesWritten: 11                                                                                                  
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-201	->	Tez vertex scope-203,
Tez vertex scope-202	->	Tez vertex scope-203,
Tez vertex scope-203	->	Tez vertex scope-204,
Tez vertex scope-204

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-201          4          4        2999671                    0        2999671           1024        169844961      376276078                0 lineitem,lpart		
scope-202          1          1         100000                    0         100000            256          3855647       11944438                0 lpart,part		
scope-203          5          5              0              3099671             25      171319391         83324374              0                0 fltResult,grpResult,lpart,revenue,volume	HASH_JOIN	
scope-204          1          1              0                    5              1            283               31              0               11 revenue	GROUP_BY	/tpch-pig/out/Q19out,

Input(s):
Successfully read 100000 records (11944438 bytes) from: "/tpch-pig/in/part"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"

Output(s):
Successfully stored 1 records (11 bytes) in: "/tpch-pig/out/Q19out"

37316 [main] INFO  org.apache.pig.Main  - Pig script completed in 37 seconds and 472 milliseconds (37472 ms)
37316 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
37328 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@4b44434a
Q19 times (sec):	38

Clear buffer cache on HDFS cluster
Running Pig Query Q20
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q20.pig

62   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
63   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
937  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1048 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1528 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q20.pig-ce644f15-1a58-469e-b228-758763bfbb1e
1528 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2505 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_DOUBLE 1 time(s).
2540 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,DISTINCT,FILTER
2577 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2616 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2666 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $4, $5, $6
2669 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for nation: $2, $3
2670 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for partsupp: $3, $4
2671 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $0, $3, $5, $6, $7, $8, $9, $11, $12, $13, $14, $15
2671 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for part: $2, $3, $4, $5, $6, $7, $8
2733 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2861 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-1343945037 and resources directory is /tmp/temp-1343945037
2893 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2950 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2973 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-211 and vertex - scope-220
3083 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3129 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3144 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3202 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3215 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3216 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3239 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3246 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3247 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3269 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3275 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3276 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3295 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3303 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3306 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3731 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3732 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3732 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3733 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3940 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-190: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3941 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: s_n,supplier
3941 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[26,11],supplier[-1,-1],s_n[28,6]
3941 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3988 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-191: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3989 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: nation,nation1,s_n
3989 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation[23,9],nation[-1,-1],nation1[24,10],nation1[-1,-1],s_n[28,6]
3989 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4029 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-192: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4029 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: s_n,s_n_ps
4030 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: s_n[28,6],s_n[-1,-1],s_n_ps[29,9]
4030 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-193: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: part,part2,part3,part4
4078 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: part[3,7],part[-1,-1],part2[5,8],part3[-1,-1],part4[7,8]
4078 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4108 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-196: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4108 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: ps_p
4108 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: ps_p[17,7]
4109 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4112 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Setting distinct combiner class between scope-193 and scope-196
4132 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-200: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4132 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: partsupp,partsupp1,ps_p
4132 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: partsupp[15,11],partsupp1[-1,-1],ps_p[17,7]
4132 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4175 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-201: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4175 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l_ps_p,ps_p
4175 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: ps_p[17,7],ps_p[-1,-1],l_ps_p[18,9]
4176 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4204 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-202: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4205 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: lineitem,lineitem1,lineitem2,lineitem3,lineitem4
4205 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[9,11],lineitem[-1,-1],lineitem2[11,12],lineitem1[10,12],lineitem4[13,12],lineitem3[12,12]
4205 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4236 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-203: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4236 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l_ps_p,lineitem4
4236 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem4[13,12],l_ps_p[18,9]
4237 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
4269 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-204: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4270 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: l_ps_p,l_ps_p2,ps_suppkey_distinct,ps_suppkey_prj
4270 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: l_ps_p[18,9],l_ps_p[-1,-1],l_ps_p2[19,10],ps_suppkey_prj[20,17],ps_suppkey_distinct[21,22]
4270 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4291 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-207: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4291 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: s_n_ps
4291 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: s_n_ps[29,9]
4292 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4292 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Setting distinct combiner class between scope-204 and scope-207
4313 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-211: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4314 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: res,res_prj,s_n_ps
4314 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: s_n_ps[29,9],res_prj[31,10],res[32,6]
4314 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN,SAMPLER
4340 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-220: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4340 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4340 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4340 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4361 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-230: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4361 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: res
4361 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: res[32,6]
4361 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4388 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-232: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4388 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4388 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4388 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4423 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 18
4458 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8585 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q20.pig-0_scope-0
9129 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q20.pig-0_scope-0. Application id: application_1564404443351_0044
9452 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0044
10131 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 18 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30131 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 18 Succeeded: 11 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
36286 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 18 Succeeded: 18 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=Counters: 75
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=1
		NUM_SUCCEEDED_TASKS=18
		TOTAL_LAUNCHED_TASKS=19
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=8
		AM_CPU_MILLISECONDS=4240
		AM_GC_TIME_MILLIS=77
	File System Counters
		FILE_BYTES_READ=25039438
		FILE_BYTES_WRITTEN=39429065
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=447786717
		HDFS_BYTES_WRITTEN=2043
		HDFS_READ_OPS=20
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=1
		REDUCE_INPUT_GROUPS=804128
		REDUCE_INPUT_RECORDS=1186238
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=2372476
		NUM_SHUFFLED_INPUTS=18
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=16
		GC_TIME_MILLIS=1964
		CPU_MILLISECONDS=81220
		PHYSICAL_MEMORY_BYTES=17843617792
		VIRTUAL_MEMORY_BYTES=125449338880
		COMMITTED_HEAP_BYTES=17843617792
		INPUT_RECORDS_PROCESSED=3504743
		INPUT_SPLIT_LENGTH_BYTES=447786717
		OUTPUT_RECORDS=1217329
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=26667777
		OUTPUT_BYTES_WITH_OVERHEAD=25174626
		OUTPUT_BYTES_PHYSICAL=25174746
		ADDITIONAL_SPILLS_BYTES_WRITTEN=14253791
		ADDITIONAL_SPILLS_BYTES_READ=25035723
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=16
		SHUFFLE_BYTES=25174698
		SHUFFLE_BYTES_DECOMPRESSED=25174626
		SHUFFLE_BYTES_TO_MEM=14390299
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=10784399
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=926
		MERGE_PHASE_TIME=1561
		FIRST_EVENT_RECEIVED=405
		LAST_EVENT_RECEIVED=430
	MultiStoreCounters
		Output records in _0_Q20out=46
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=457733
		COMBINE_OUTPUT_RECORDS=426741
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('true')
		approx_invocations=100
		approx_microsecs=199400
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=454900
		approx_microsecs=983100
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=346700
		approx_microsecs=1077100
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=424000
		approx_microsecs=2424800
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=2245900
	org.apache.pig.builtin.SUBSTRING
		approx_invocations=100000
		approx_microsecs=240700
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=21700
36468 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q20.pig                                                                                     
           StartedAt: 2019-08-05 18:11:07                                                                                 
          FinishedAt: 2019-08-05 18:11:41                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,DISTINCT,FILTER                                                         

Success!


DAG 0:
                                    Name: PigLatin:Q20.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0044                                                                              
                      TotalLaunchedTasks: 19                                                                                                  
                           FileBytesRead: 25039438                                                                                            
                        FileBytesWritten: 39429065                                                                                            
                           HdfsBytesRead: 447786717                                                                                           
                        HdfsBytesWritten: 2043                                                                                                
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-190	->	Tez vertex scope-192,
Tez vertex scope-191	->	Tez vertex scope-192,
Tez vertex scope-192	->	Tez vertex scope-211,
Tez vertex scope-193	->	Tez vertex scope-196,
Tez vertex scope-196	->	Tez vertex scope-201,
Tez vertex scope-200	->	Tez vertex scope-201,
Tez vertex scope-201	->	Tez vertex scope-204,
Tez vertex scope-202	->	Tez vertex scope-203,
Tez vertex scope-203	->	Tez vertex scope-204,
Tez vertex scope-204	->	Tez vertex scope-207,
Tez vertex scope-207	->	Tez vertex scope-211,
Tez vertex scope-211	->	Tez vertex scope-220,Tez vertex scope-230,
Tez vertex scope-220	->	Tez vertex scope-230,
Tez vertex scope-230	->	Tez vertex scope-232,
Tez vertex scope-232

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-190          1          1           5000                    0           5000             64           280152         699860                0 s_n,supplier		
scope-191          1          1             25                    0              1             64               53           2199                0 nation,nation1,s_n		
scope-192          1          1              0                 5001            210         280205           293606              0                0 s_n,s_n_ps	HASH_JOIN	
scope-193          1          1         100000                    0           1148             64            14199       11944438                0 part,part2,part3,part4		
scope-196          1          1              0                 1147           1147          14263            17247              0                0 ps_p		
scope-200          1          1         400000                    0         400000             64          5289750       58864142                0 partsupp,partsupp1,ps_p		
scope-201          1          1              0               401147           4588        5307061            84065              0                0 l_ps_p,ps_p	HASH_JOIN	
scope-202          4          4        2999671                    0         454614            256         10873716      376276078                0 lineitem,lineitem1,lineitem2,lineitem3,lineitem4		
scope-203          1          1              0               423775         346640       10737286         13851221              0                0 l_ps_p,lineitem4	GROUP_BY	
scope-204          1          1              0               351228           1977        8631665          8651620              0                0 l_ps_p,l_ps_p2,ps_suppkey_distinct,ps_suppkey_prj	HASH_JOIN	
scope-207          1          1              0                 1819           1819          20051            47314              0                0 s_n_ps		
scope-211          1          1              0                 2029             92          40824            18505              0                0 res,res_prj,s_n_ps	HASH_JOIN,SAMPLER	
scope-220          1          1              0                   46              1           2541             2651              0                0 		
scope-230          1          1             47                    0             46           2563             2499              0                0 res		
scope-232          1          1              0                   46             46           2467             2467              0             2043 	ORDER_BY	/tpch-pig/out/Q20out,

Input(s):
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"
Successfully read 400000 records (58864142 bytes) from: "/tpch-pig/in/partsupp"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"
Successfully read 100000 records (11944438 bytes) from: "/tpch-pig/in/part"

Output(s):
Successfully stored 46 records (2043 bytes) in: "/tpch-pig/out/Q20out"

36491 [main] INFO  org.apache.pig.Main  - Pig script completed in 36 seconds and 653 milliseconds (36653 ms)
36491 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
36506 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@51043bd5
Q20 times (sec):	38

Clear buffer cache on HDFS cluster
Running Pig Query Q21
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q21.pig

70   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
71   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
987  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1101 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1595 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q21.pig-7c42e467-8561-4070-bfd7-aa118a073b64
1595 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2565 [main] WARN  org.apache.pig.newplan.BaseOperatorPlan  - Encountered Warning IMPLICIT_CAST_TO_LONG 2 time(s).
2602 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: REPLICATED_JOIN,HASH_JOIN,GROUP_BY,ORDER_BY,FILTER,LIMIT
2638 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2679 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2729 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2840 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for lineitem: $1, $3, $4, $5, $6, $7, $8, $9, $10, $13, $14, $15
2842 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $1, $3, $4, $5, $6, $7, $8
2843 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for supplier: $2, $4, $5, $6
2993 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp-1614959858 and resources directory is /tmp/temp-1614959858
3034 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
3099 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
3123 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-159 and vertex - scope-169
3211 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3252 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 1
3266 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3320 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3327 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3328 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3356 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3363 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3364 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 4
3389 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3395 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3396 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3432 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-158 to 11
3787 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3787 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3787 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3787 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
4004 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-155: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4004 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fn,nation
4004 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: nation[9,9],nation[-1,-1],fn[33,5]
4004 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4053 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-154: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4054 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fn_s,fn_s_L3,supplier
4054 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: supplier[7,11],supplier[-1,-1],fn_s[34,7],fn_s_L3[36,10]
4054 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: REPLICATED_JOIN
4122 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-147: parallelism=4, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4122 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: gl,lineitem
4122 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: lineitem[5,11],lineitem[-1,-1],gl[16,5]
4123 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4192 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-148: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4193 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: L2,L3,fL2,fL3,fn_s_L3,t1
4193 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: L2[18,5],fL2[20,6],t1[21,13],fL2[-1,-1],fL3[27,6],L3[29,5],fn_s_L3[36,10]
4194 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,MULTI_QUERY
4244 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-156: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4245 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fn_s_L3,fn_s_L3_fo
4245 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: fn_s_L3[36,10],fn_s_L3_fo[39,13]
4245 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4272 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-157: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4272 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fn_s_L3_fo,fo,orders
4272 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[3,9],orders[-1,-1],fo[38,5],orders[13,9],fn_s_L3_fo[39,13]
4273 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4304 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-158: parallelism=11, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4305 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: fn_s_L3_fo,gres,sres
4305 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: fn_s_L3_fo[39,13],sres[42,7],gres[41,7]
4306 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4336 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-159: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4336 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: ores,sres
4337 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: sres[42,7],ores[43,7]
4337 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4374 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-169: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4374 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4374 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4374 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4396 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-180: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4397 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: ores
4397 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: ores[43,7]
4397 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4425 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-182: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4426 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4426 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4426 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4454 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 24
4492 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8897 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q21.pig-0_scope-0
9491 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q21.pig-0_scope-0. Application id: application_1564404443351_0045
10484 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0045
10496 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 24 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
30496 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 24 Succeeded: 7 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
50495 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 24 Succeeded: 9 Running: 1 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=null
55712 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 24 Succeeded: 24 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 2, diagnostics=, counters=Counters: 79
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=2
		NUM_SUCCEEDED_TASKS=24
		TOTAL_LAUNCHED_TASKS=25
		OTHER_LOCAL_TASKS=1
		DATA_LOCAL_TASKS=7
		AM_CPU_MILLISECONDS=4720
		AM_GC_TIME_MILLIS=63
	File System Counters
		FILE_BYTES_READ=119510721
		FILE_BYTES_WRITTEN=152921628
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=462087282
		HDFS_BYTES_WRITTEN=72960398
		HDFS_READ_OPS=19
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=4
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=2
		REDUCE_INPUT_GROUPS=1127335
		REDUCE_INPUT_RECORDS=3468528
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=6937078
		NUM_SHUFFLED_INPUTS=44
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=41
		GC_TIME_MILLIS=1884
		CPU_MILLISECONDS=95060
		PHYSICAL_MEMORY_BYTES=34338242560
		VIRTUAL_MEMORY_BYTES=179821932544
		COMMITTED_HEAP_BYTES=34338242560
		INPUT_RECORDS_PROCESSED=3754890
		INPUT_SPLIT_LENGTH_BYTES=462087282
		OUTPUT_RECORDS=4111922
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=136990299
		OUTPUT_BYTES_WITH_OVERHEAD=119483493
		OUTPUT_BYTES_PHYSICAL=119483741
		ADDITIONAL_SPILLS_BYTES_WRITTEN=33436711
		ADDITIONAL_SPILLS_BYTES_READ=119475498
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=21
		SHUFFLE_BYTES=119483669
		SHUFFLE_BYTES_DECOMPRESSED=119483493
		SHUFFLE_BYTES_TO_MEM=33438804
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=86044865
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=3377
		MERGE_PHASE_TIME=4225
		FIRST_EVENT_RECEIVED=546
		LAST_EVENT_RECEIVED=2675
	MultiInputCounters
		Input records from _0_supplier=5000
	MultiStoreCounters
		Output records in _0_Q21_fL2_fL2=642791
		Output records in _0_Q21out=100
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=973
		COMBINE_OUTPUT_RECORDS=767
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('false','true')
		approx_invocations=100
		approx_microsecs=306700
	org.apache.pig.builtin.COUNT
		approx_invocations=1392800
		approx_microsecs=1645000
	org.apache.pig.builtin.COUNT$Final
		approx_invocations=200
		approx_microsecs=9300
	org.apache.pig.builtin.COUNT$Initial
		approx_invocations=1300
		approx_microsecs=386100
	org.apache.pig.builtin.COUNT$Intermediate
		approx_invocations=1100
		approx_microsecs=127000
	org.apache.pig.builtin.Distinct
		approx_invocations=1392800
		approx_microsecs=4955200
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=1760400
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=7200
55807 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.JobStats  - using output size reader: org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.FileBasedOutputSizeReader
56503 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q21.pig                                                                                     
           StartedAt: 2019-08-05 18:11:48                                                                                 
          FinishedAt: 2019-08-05 18:12:41                                                                                 
            Features: REPLICATED_JOIN,HASH_JOIN,GROUP_BY,ORDER_BY,FILTER,LIMIT                                            

Success!


DAG 0:
                                    Name: PigLatin:Q21.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0045                                                                              
                      TotalLaunchedTasks: 25                                                                                                  
                           FileBytesRead: 119510721                                                                                           
                        FileBytesWritten: 152921628                                                                                           
                           HdfsBytesRead: 462087282                                                                                           
                        HdfsBytesWritten: 72960398                                                                                            
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-155	->	Tez vertex scope-154,
Tez vertex scope-154	->	Tez vertex scope-156,
Tez vertex scope-147	->	Tez vertex scope-148,
Tez vertex scope-148	->	Tez vertex scope-156,
Tez vertex scope-156	->	Tez vertex scope-158,
Tez vertex scope-157	->	Tez vertex scope-158,
Tez vertex scope-158	->	Tez vertex scope-159,
Tez vertex scope-159	->	Tez vertex scope-169,Tez vertex scope-180,
Tez vertex scope-169	->	Tez vertex scope-180,
Tez vertex scope-180	->	Tez vertex scope-182,
Tez vertex scope-182

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-147          4          4        2999671                    0        2999671            256        108486734      376276078                0 gl,lineitem		
scope-148          1          1              0              2999671         743739      108486766         30751215              0         72958293 L2,L3,fL2,fL3,fn_s_L3,t1	GROUP_BY,MULTI_QUERY	/tpch-pig/out/Q21_fL2_fL2,
scope-154          1          1           5001                    0            194            215            26814         699860                0 fn_s,fn_s_L3,supplier	REPLICATED_JOIN	
scope-155          1          1             25                    0              1              0              151           2199                0 fn,nation		
scope-156          1          1              0               101142           1968        3688286           338844              0                0 fn_s_L3,fn_s_L3_fo	HASH_JOIN	
scope-157          1          1         750000                    0         364780            544          6931202       85109145                0 fn_s_L3_fo,fo,orders		
scope-158         11         11              0               366748            984        7296503          6356568              0                0 fn_s_L3_fo,gres,sres	HASH_JOIN	
scope-159          1          1              0                  767            292          20129            12031              0                0 ores,sres	GROUP_BY,SAMPLER	
scope-169          1          1              0                  100              1           6008             6119              0                0 		
scope-180          1          1            193                    0            192           6055             5991              0                0 ores		
scope-182          1          1              0                  100            100           5959             5959              0             2105 	ORDER_BY	/tpch-pig/out/Q21out,

Input(s):
Successfully read 25 records (2199 bytes) from: "/tpch-pig/in/nation"
Successfully read 2999671 records (376276078 bytes) from: "/tpch-pig/in/lineitem"
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 5000 records (699860 bytes) from: "/tpch-pig/in/supplier"

Output(s):
Successfully stored 642791 records (72958293 bytes) in: "/tpch-pig/out/Q21_fL2_fL2"
Successfully stored 100 records (2105 bytes) in: "/tpch-pig/out/Q21out"

Deleted /tpch-pig/out/Q21_fL2_fL2
56625 [main] INFO  org.apache.pig.Main  - Pig script completed in 56 seconds and 782 milliseconds (56782 ms)
56629 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
56643 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@e015a87
Q21 times (sec):	59

Clear buffer cache on HDFS cluster
Running Pig Query Q22
Going to run:
/home/ubuntu/opt/pig-0.17.0/bin/pig -param input=/tpch-pig/in -param output=/tpch-pig/out -param reducers=1 -f queries/Q22.pig

64   [main] INFO  org.apache.pig.Main  - Apache Pig version 0.17.0 (r1797386) compiled Jun 02 2017, 15:41:58
65   [main] INFO  org.apache.pig.Main  - Logging error messages to: /mnt/temp/pig-err.log
997  [main] INFO  org.apache.pig.impl.util.Utils  - Default bootup file /home/ubuntu/.pigbootup not found
1115 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://kariz-1:9000
1603 [main] INFO  org.apache.pig.PigServer  - Pig Script ID for the session: PIG-Q22.pig-2cae35a9-8cbd-46cf-8c02-5100ad7eb43c
1604 [main] WARN  org.apache.pig.PigServer  - ATS is disabled since yarn.timeline-service.enabled set to false
2540 [main] INFO  org.apache.pig.tools.pigstats.ScriptState  - Pig features used in the script: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER
2574 [main] INFO  org.apache.pig.data.SchemaTupleBackend  - Key [pig.schematuple] was not set... will not generate code.
2607 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer  - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, ConstantCalculator, GroupByConstParallelSetter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NestedLimitOptimizer, PartitionFilterOptimizer, PredicatePushdownOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter]}
2641 [main] INFO  org.apache.pig.newplan.logical.rules.ColumnPruneVisitor  - Columns pruned for orders: $0, $2, $3, $4, $5, $6, $7, $8
2694 [main] INFO  org.apache.pig.impl.util.SpillableMemoryManager  - Selected heap (PS Old Gen) of size 699400192 to monitor. collectionUsageThreshold = 489580128, usageThreshold = 489580128
2811 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Tez staging directory is /tmp/temp310166350 and resources directory is /tmp/temp310166350
2843 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.TezCompiler  - File concatenation threshold: 100 optimistic? false
2900 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2913 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.CombinerOptimizerUtil  - Choosing to move algebraic foreach to combiner
2929 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.SecondaryKeyOptimizerTez  - Using Secondary Key Optimization in the edge between vertex - scope-136 and vertex - scope-145
3019 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3060 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3076 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3132 [main] INFO  org.apache.pig.builtin.PigStorage  - Using PigTextInputFormat
3138 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths to process : 4
3139 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil  - Total input paths (combined) to process : 1
3155 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.plan.optimizer.ParallelismSetter  - Increased requested parallelism of scope-135 to 2
3575 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: joda-time-2.9.4.jar
3575 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: pig-0.17.0-core-h2.jar
3575 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: antlr-runtime-3.4.jar
3576 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Local resource: automaton-1.11-8.jar
3802 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-127: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3803 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: avg_customer_filter,customer,customer_filter,customer_filter_group
3803 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[3,11],customer[-1,-1],customer_filter[6,18],avg_customer_filter[8,22],customer_filter_group[7,24]
3803 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: MULTI_QUERY
3871 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-131: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3872 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: avg_customer_filter
3872 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: avg_customer_filter[8,22]
3872 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY
3931 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-132: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3931 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: customer,customer_orders_left,customer_sec_filter
3931 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer[-1,-1],customer_sec_filter[10,22],customer_orders_left[11,23]
3931 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3954 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-134: parallelism=1, memory=4096, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx3072m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3954 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: customer_orders_left,orders
3955 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: orders[4,9],orders[-1,-1],customer_orders_left[11,23]
3955 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
3993 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-135: parallelism=2, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
3993 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: customer_orders_left,customer_result,customer_result_group,customer_rows,customer_trd_filter
3993 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer_orders_left[11,23],customer_orders_left[-1,-1],customer_trd_filter[13,22],customer_rows[14,16],customer_result[17,18],customer_result_group[16,24]
3994 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: HASH_JOIN
4022 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-136: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4022 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: customer_result,customer_result_inorder
4022 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer_result[17,18],customer_result_inorder[18,26]
4022 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: GROUP_BY,SAMPLER
4056 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-145: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4056 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4056 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4056 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-155: parallelism=-1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: customer_result_inorder
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: customer_result_inorder[18,26]
4077 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: 
4105 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - For vertex - scope-157: parallelism=1, memory=8192, java opts=-Djava.net.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx6144m -Dlog4j.configuratorClass=org.apache.tez.common.TezLog4jConfigurator -Dlog4j.configuration=tez-container-log4j.properties -Dyarn.app.container.log.dir=<LOG_DIR> -Dtez.root.logger=INFO,CLA 
4105 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Processing aliases: 
4105 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Detailed locations: 
4105 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezDagBuilder  - Pig features in the vertex: ORDER_BY
4137 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJobCompiler  - Total estimated parallelism is 10
4173 [PigTezLauncher-0] INFO  org.apache.pig.tools.pigstats.tez.TezScriptState  - Pig script settings are added to the job
8898 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitting DAG PigLatin:Q22.pig-0_scope-0
9421 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - Submitted DAG PigLatin:Q22.pig-0_scope-0. Application id: application_1564404443351_0046
10167 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - HadoopJobId: job_1564404443351_0046
10424 [Timer-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=RUNNING, progress=TotalTasks: 10 Succeeded: 0 Running: 0 Failed: 0 Killed: 0, diagnostics=, counters=null
25556 [PigTezLauncher-0] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezJob  - DAG Status: status=SUCCEEDED, progress=TotalTasks: 10 Succeeded: 10 Running: 0 Failed: 0 Killed: 0 KilledTaskAttempts: 1, diagnostics=, counters=Counters: 91
	org.apache.tez.common.counters.DAGCounter
		NUM_KILLED_TASKS=1
		NUM_SUCCEEDED_TASKS=10
		TOTAL_LAUNCHED_TASKS=10
		OTHER_LOCAL_TASKS=2
		DATA_LOCAL_TASKS=2
		AM_CPU_MILLISECONDS=3800
		AM_GC_TIME_MILLIS=69
	File System Counters
		FILE_BYTES_READ=17715056
		FILE_BYTES_WRITTEN=17710586
		FILE_READ_OPS=0
		FILE_LARGE_READ_OPS=0
		FILE_WRITE_OPS=0
		HDFS_BYTES_READ=97180087
		HDFS_BYTES_WRITTEN=147
		HDFS_READ_OPS=11
		HDFS_LARGE_READ_OPS=0
		HDFS_WRITE_OPS=2
	org.apache.tez.common.counters.TaskCounter
		NUM_SPECULATIONS=1
		REDUCE_INPUT_GROUPS=109150
		REDUCE_INPUT_RECORDS=759478
		COMBINE_INPUT_RECORDS=0
		SPILLED_RECORDS=1518956
		NUM_SHUFFLED_INPUTS=13
		NUM_SKIPPED_INPUTS=0
		NUM_FAILED_SHUFFLE_INPUTS=0
		MERGED_MAP_OUTPUTS=9
		GC_TIME_MILLIS=1054
		CPU_MILLISECONDS=32580
		PHYSICAL_MEMORY_BYTES=11148984320
		VIRTUAL_MEMORY_BYTES=77841059840
		COMMITTED_HEAP_BYTES=11148984320
		INPUT_RECORDS_PROCESSED=900009
		INPUT_SPLIT_LENGTH_BYTES=97180087
		OUTPUT_RECORDS=856663
		OUTPUT_LARGE_RECORDS=0
		OUTPUT_BYTES=23370836
		OUTPUT_BYTES_WITH_OVERHEAD=17710134
		OUTPUT_BYTES_PHYSICAL=17710282
		ADDITIONAL_SPILLS_BYTES_WRITTEN=0
		ADDITIONAL_SPILLS_BYTES_READ=4690009
		ADDITIONAL_SPILL_COUNT=0
		SHUFFLE_CHUNK_COUNT=7
		SHUFFLE_BYTES=17710186
		SHUFFLE_BYTES_DECOMPRESSED=17710134
		SHUFFLE_BYTES_TO_MEM=0
		SHUFFLE_BYTES_TO_DISK=0
		SHUFFLE_BYTES_DISK_DIRECT=17710186
		NUM_MEM_TO_DISK_MERGES=0
		NUM_DISK_TO_DISK_MERGES=0
		SHUFFLE_PHASE_TIME=289
		MERGE_PHASE_TIME=277
		FIRST_EVENT_RECEIVED=105
		LAST_EVENT_RECEIVED=105
	MultiStoreCounters
		Output records in _0_Q22out=7
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	org.apache.hadoop.mapreduce.TaskCounter
		COMBINE_INPUT_RECORDS=22181
		COMBINE_OUTPUT_RECORDS=15
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.FindQuantilesTez('true')
		approx_invocations=100
		approx_microsecs=109300
	org.apache.pig.backend.hadoop.executionengine.tez.plan.udf.ReadScalarsTez('scope-131')
		approx_invocations=75000
		approx_microsecs=314100
	org.apache.pig.builtin.AlgebraicMathBase$Initial
		approx_invocations=3300
		approx_microsecs=20400
	org.apache.pig.builtin.COUNT$Final
		approx_invocations=100
		approx_microsecs=18800
	org.apache.pig.builtin.COUNT$Initial
		approx_invocations=3300
		approx_microsecs=223900
	org.apache.pig.builtin.COUNT$Intermediate
		approx_invocations=200
		approx_microsecs=41600
	org.apache.pig.builtin.DoubleAvg$Final
		approx_invocations=100
		approx_microsecs=223000
	org.apache.pig.builtin.DoubleAvg$Initial
		approx_invocations=19000
		approx_microsecs=209500
	org.apache.pig.builtin.DoubleAvg$Intermediate
		approx_invocations=100
		approx_microsecs=1459200
	org.apache.pig.builtin.DoubleSum$Final
		approx_invocations=100
		approx_microsecs=9400
	org.apache.pig.builtin.DoubleSum$Intermediate
		approx_invocations=200
		approx_microsecs=208400
	org.apache.pig.builtin.IsEmpty
		approx_invocations=9600
		approx_microsecs=87300
	org.apache.pig.builtin.PigStorage@7c
		approx_microsecs=582300
	org.apache.pig.builtin.SUBSTRING
		approx_invocations=108900
		approx_microsecs=600700
	org.apache.pig.impl.builtin.GetMemNumRows
		approx_invocations=100
		approx_microsecs=20200
26181 [main] INFO  org.apache.pig.tools.pigstats.tez.TezPigScriptStats  - Script Statistics:

       HadoopVersion: 2.8.4                                                                                               
          PigVersion: 0.17.0                                                                                              
          TezVersion: 0.9.0                                                                                               
              UserId: ubuntu                                                                                              
            FileName: queries/Q22.pig                                                                                     
           StartedAt: 2019-08-05 18:12:48                                                                                 
          FinishedAt: 2019-08-05 18:13:12                                                                                 
            Features: HASH_JOIN,GROUP_BY,ORDER_BY,FILTER                                                                  

Success!


DAG 0:
                                    Name: PigLatin:Q22.pig-0_scope-0                                                                          
                           ApplicationId: job_1564404443351_0046                                                                              
                      TotalLaunchedTasks: 10                                                                                                  
                           FileBytesRead: 17715056                                                                                            
                        FileBytesWritten: 17710586                                                                                            
                           HdfsBytesRead: 97180087                                                                                            
                        HdfsBytesWritten: 147                                                                                                 
      SpillableMemoryManager spill count: 0                                                                                                   
                Bags proactively spilled: 0                                                                                                   
             Records proactively spilled: 0                                                                                                   

DAG Plan:
Tez vertex scope-127	->	Tez vertex scope-131,Tez vertex scope-132,
Tez vertex scope-131	->	Tez vertex scope-132,
Tez vertex scope-132	->	Tez vertex scope-135,
Tez vertex scope-134	->	Tez vertex scope-135,
Tez vertex scope-135	->	Tez vertex scope-136,
Tez vertex scope-136	->	Tez vertex scope-145,Tez vertex scope-155,
Tez vertex scope-145	->	Tez vertex scope-155,
Tez vertex scope-155	->	Tez vertex scope-157,
Tez vertex scope-157

Vertex Stats:
VertexId Parallelism TotalTasks   InputRecords   ReduceInputRecords  OutputRecords  FileBytesRead FileBytesWritten  HdfsBytesRead HdfsBytesWritten Alias	Feature	Outputs
scope-127          1          1          75000                    0          93963             64         13020027       12070942                0 avg_customer_filter,customer,customer_filter,customer_filter_group	MULTI_QUERY	
scope-131          1          1              0                    1              1             66               54              0                0 avg_customer_filter	GROUP_BY	
scope-132          1          1          75001                    0           9449       13020127           396934              0                0 customer,customer_orders_left,customer_sec_filter		
scope-134          1          1         750000                    0         750000            112          4292461       85109145                0 customer_orders_left,orders		
scope-135          2          2              0               759449           3221        4693449              420              0                0 customer_orders_left,customer_result,customer_result_group,customer_rows,customer_trd_filter	HASH_JOIN	
scope-136          1          1              0                   14             14            484              400              0                0 customer_result,customer_result_inorder	GROUP_BY,SAMPLER	
scope-145          1          1              0                    7              1            204               94              0                0 		
scope-155          1          1              8                    0              7            354              196              0                0 customer_result_inorder		
scope-157          1          1              0                    7              7            196                0              0              147 	ORDER_BY	/tpch-pig/out/Q22out,

Input(s):
Successfully read 750000 records (85109145 bytes) from: "/tpch-pig/in/orders"
Successfully read 75000 records (12070942 bytes) from: "/tpch-pig/in/customer"

Output(s):
Successfully stored 7 records (147 bytes) in: "/tpch-pig/out/Q22out"

26205 [main] INFO  org.apache.pig.Main  - Pig script completed in 26 seconds and 369 milliseconds (26369 ms)
26220 [main] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezLauncher  - Shutting down thread pool
26234 [pool-1-thread-1] INFO  org.apache.pig.backend.hadoop.executionengine.tez.TezSessionManager  - Shutting down Tez session org.apache.tez.client.TezClient@521a60a8
Q22 times (sec):	28

Total times (sec):	781

